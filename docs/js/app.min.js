(function(){"use strict";var n=angular.module("app",["ngRoute","ngSanitize","jsonFormatter"])})(),function(){"use strict";var n=angular.module("app");n.config(["$httpProvider",function(){}])}(),function(){"use strict";var n=angular.module("app");n.config(["$locationProvider",function(n){n.html5Mode(!0);n.hashPrefix("")}])}(),function(){"use strict";var n=angular.module("app");n.run(["$rootScope",function(){}])}(),function(){"use strict";var n=angular.module("app");n.factory("DatGui",["$rootScope","SceneOptions","StepperService",function(n,t,i){function u(){function e(){var t=h.getCurrentStep();t.colors.background=u.colors.background;t.colors.lines=u.colors.lines;t.colors.overLines=u.colors.overLines;t.camera.cameraHeight=u.camera.cameraHeight;t.camera.targetHeight=u.camera.targetHeight;t.circle.position.copy(u.circle.position);n.$broadcast("onOptionsChanged")}function c(n){var t=n.key.toLowerCase();t==="a"&&n.ctrlKey&&$(document).find("body").toggleClass("gui-active")}var u=t,h=i,f=new dat.GUI,o,s;u.randomize=function(){for(var n,i,t=0;t<f.__controllers.length;t++)n=f.__controllers[t],n.__min&&(i=n.__min+(n.__max-n.__min)*Math.random(),this[n.property]=i,n.updateDisplay()),n.__color&&(n.__color.r=Math.floor(Math.random()*255),n.__color.g=Math.floor(Math.random()*255),n.__color.b=Math.floor(Math.random()*255),n.updateDisplay(),n.setValue(n.__color.hex))};u.saveJson=function(){console.log("saveJson");r(h.steps,"rossini.js",!0,!0)};f.closed=!0;f.add(u.camera,"cameraHeight",-20,20).listen().onChange(e);f.add(u.camera,"targetHeight",-20,20).listen().onChange(e);o=f.addFolder("circlePosition");o.add(u.circle.position,"x",-300,300).listen().onChange(e);o.add(u.circle.position,"y",-300,300).listen().onChange(e);o.add(u.circle.position,"z",-300,300).listen().onChange(e);s=f.addFolder("colors");s.addColor(u.colors,"background").listen().onChange(e);s.addColor(u.colors,"lines").listen().onChange(e);s.addColor(u.colors,"overLines").listen().onChange(e);f.add(u.audio,"volume",.01,1).onChange(e);f.add(u,"audioStrength",10,100).onChange(e);f.add(u,"noiseStrength",10,100).onChange(e);f.add(u,"circularStrength",.01,.9).onChange(e);f.add(u,"randomize");f.add(u,"saveJson");e();angular.element(window).on("keydown",c);return f}var r=function(){var n=document.createElement("a");return document.body.appendChild(n),n.style="display: none",function(t,i,r,u){r&&(t=u?JSON.stringify(t,null,2):JSON.stringify(t));var e=new Blob([t],{type:"octet/stream"}),f=window.URL.createObjectURL(e);n.href=f;n.download=i;n.click();window.URL.revokeObjectURL(f)}}();return u}])}(),function(){"use strict";var n=angular.module("app");n.directive("scrollbar",[function(){return{restrict:"A",link:function(n,t){function u(){var t=Scrollbar.init(i,r);n.$watch(t.contentEl.offsetHeight,function(){t.update()})}var i=t[0],r={speed:1,damping:.1,overscrollDamping:1,thumbMinSize:20,continuousScrolling:!0,alwaysShowTracks:!1};setTimeout(u,100)}}}])}(),function(){"use strict";var n=angular.module("app");n.directive("slickBackgrounds",[function(){return{restrict:"A",link:function(n,t,i){function r(){t.hasClass("slick-initialized")&&t.slick("unslick")}function u(){r();t.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,lazyLoad:"ondemand",cssEase:"cubic-bezier(0.7, 0, 0.3, 1)"})}n.$watchCollection(i.slickBackgrounds,function(n){n&&n.length&&setTimeout(u,1)});n.$on("$destroy",function(){r()})}}}]);n.directive("slickTunnel",[function(){return{restrict:"A",link:function(n,t,i){function u(){t.hasClass("slick-initialized")&&t.slick("unslick")}function h(){u();t.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,draggable:!1,asNavFor:".tunnel-bg",cssEase:"cubic-bezier(0.7, 0, 0.3, 1)"})}function f(){var n=$(".slick-active .splitted-letter");TweenMax.staggerTo(n,1,{delay:.2,y:0,x:0,ease:Power3.easeInOut,className:"+=viewed",onComplete:function(){$(".slick-active .cta").addClass("active")}},.009)}function e(t,i,u,f){r=!0;var e=$(".slick-active .splitted-letter");TweenMax.staggerTo(e,1,{delay:0,y:100,x:50,ease:Power3.easeInOut,className:"-=viewed"},.009);$(".slick-active .cta").removeClass("active");n.$root.$broadcast("onSlickBeforeChange",{current:f,previouse:u})}function o(){r=!1;var t=$(".slick-active .splitted-letter");TweenMax.staggerTo(t,1,{delay:.2,y:0,x:0,ease:Power3.easeInOut,className:"+=viewed",onComplete:function(){$(".slick-active .cta").addClass("active")}},.009);n.$root.$broadcast("onAfterChange")}function s(n){r||(t.hasClass("slick-initialized")&&(n.deltaX>0||n.deltaY<0?t.slick("slickNext"):(n.deltaX<0||n.deltaY>0)&&t.slick("slickPrev")),n.preventDefault())}function c(){t.on("init",f).on("beforeChange",e).on("afterChange",o).on("mousewheel",s)}function l(){t.off("init",f).off("beforeChange",e).off("afterChange",o).off("mousewheel",s)}n.$watchCollection(i.slickTunnel,function(n){n&&n.length&&h()});var r=!1;n.$on("onGoStep",function(n,i){t.hasClass("slick-initialized")&&t.slick("slickGoTo",i)});c();n.$on("$destroy",function(){l();u()})}}}])}(),function(){"use strict";var n=angular.module("app");n.directive("splitText",[function(){return{restrict:"A",link:function(n,t){function i(){var e=t[0].childNodes,n,i,o,r,u,v,s,f,h;for(e=Array.prototype.slice.call(e,0),t.html("").addClass("active"),n=[[]],e.filter(function(n){return n.nodeType===3||n.nodeType===1}).map(function(t){if(t.nodeType===3)t={text:$.trim(t.textContent),element:"span"};else{if(t.nodeName.toLowerCase()==="br"){n.push([]);return}t={text:$.trim(t.innerHTML),element:t.nodeName}}t.text!==""&&n[n.length-1].push(t)}),i=0;i<n.length;i++)for(o=n[i],$('<div class="splitted-row"><\/div>').appendTo(t),r=0;r<o.length;r++){var c=o[r],l=c.element.toLowerCase(),y=c.text,a=y.split(" ");for(u=0;u<a.length;u++){for($("<"+l+' class="splitted-word"><\/'+l+">").appendTo($(".splitted-row:last"),t),v=a[u],s=v.split(""),f=0;f<s.length;f++)h=s[f],$('<span class="splitted-letter" data-content="'+h+'">'+h+"<\/span>").appendTo($(".splitted-word:last"),t);$('<span class="splitted-space">&nbsp;<\/span>').appendTo($(".splitted-word:last"),t)}}}setTimeout(function(){i()},1)}}}])}(),function(){"use strict";var n=angular.module("app");n.directive("yearsFrom",[function(){return{restrict:"A",scope:{from:"=yearsFrom",to:"=yearsTo"},link:function(n,t){function i(){function f(){e.html(parseInt(i.from));o.html(parseInt(i.to))}var e=t.find(".tunnel-year__from"),o=t.find(".tunnel-year__to"),r=2,u=Power3.easeOut,i={from:e.html(),to:o.html()};n.to?(t.removeClass("one-year"),TweenLite.to(i,r,{to:n.to,roundProps:"year",onUpdate:f,ease:u})):(t.addClass("one-year"),TweenLite.to(i,r,{to:n.from,roundProps:"year",onUpdate:f,ease:u}));TweenLite.to(i,r,{from:n.from,roundProps:"year",onUpdate:f,ease:u})}n.$watch("from",function(n){n&&i()})}}}])}(),function(){"use strict";var n=angular.module("app");n.controller("RootCtrl",["$scope","SceneOptions","StepperService","AnalyserService","DatGui","$timeout",function(n,t,i,r,u,f){var e={objects:{},options:t,stepper:i},h=e.objects,c=e.options,s=e.stepper,o;s.init().then(function(){n.scene=e;n.stepper=s;n.audio=r;var t=new u});o={};n.openDetail=function(){return $.get(s.step.url,function(n){f(function(){o.active=!0;o.html=n})}),!1};n.detail=o;console.log("RootCtrl",t)}])}(),function(){"use strict";var n=angular.module("app");n.service("AnalyserService",["$rootScope","$timeout","$q","$http","SceneOptions","StepperService",function(n,t,i,r,u,f){function b(){if(!o){var n;o=a.createMediaElementSource(e);o.smoothingTimeConstant=.85;o.connect(h);o.connect(a.destination);h.fftSize=c.audio.bands*2;n=h.frequencyBinCount;s.data=new Uint8Array(n)}return console.log("pippo"),s.data}function k(n){l!==n&&(l=n,l&&(e.src=n,e.volume=c.audio.volume,y()))}function y(){e&&e.play()}function d(){e&&e.pause()}function g(){e&&(s.active=!s.active,s.active?e.play():e.pause())}function nt(){var n=w.getCurrentStep();k(n.audio?n.audio.url:null)}function tt(){s.data&&h.getByteFrequencyData(s.data)}function p(){var n=i.defer();return!c.device.ios||s.unlocked?n.resolve():(o=it(),t(function(){(o.playbackState===o.PLAYING_STATE||o.playbackState===o.FINISHED_STATE)&&(s.unlocked=!0,n.resolve())})),console.log("AudioAnalyser.unlock"),n.promise}function it(){var t=new v,n=t.createBufferSource(),i=t.createBuffer(1,1,22050);return n.buffer=i,n.connect(t.destination),n.noteOn&&n.noteOn(0),console.log("AudioAnalyser.doUnlock"),n}var s=this,c=u,w=f,h,e,l,v=window.AudioContext||window.webkitAudioContext,a=new v,o;h=a.createAnalyser();e=new Audio;e.addEventListener("canplay",b);o=null;s.unlocked=!1;window.addEventListener("touchstart",p,!1);n.$on("onStepChanged",function(){nt()});n.$on("onOptionsChanged",function(){e&&(e.volume=c.audio.volume)});this.active=!0;this.data=null;this.audio=e;this.update=tt;this.play=y;this.pause=d;this.toggle=g;this.unlock=p}])}(),function(){"use strict";var n=angular.module("app");n.service("StepperService",["$rootScope","$timeout","$q","$http","$sce","SceneOptions",function(n,t,i,r,u,f){function y(){var n=["Il periodo francese:<br> la nascita della <em>Grand Op√©ra<\/em>","Il Barbiere di Siviglia<br> al teatro Argentina<br> di Roma","Il Silenzio",],t=["Il giovane Gioacchino","Il folgorante debutto","La frenesia della produzione","Sulle strade di Parigi",],i=["Il Barbiere di Siviglia","L'italiana in Algeri",],r=["audio/07-rossini-192.mp3","audio/08-rossini-192.mp3",],u=["img/tunnel-1.jpg","img/tunnel-2.jpg","img/tunnel-3.jpg",],e=["light-bg","light-bg","dark-bg",];return new Array(o.ribbon.steps).fill().map(function(o,s){return{id:s+1,title:n[s%n.length],url:"view.html",chapter:"Passione, Genio e Silenzio",paragraph:t[Math.floor(s/3)%t.length],years:{from:1812+Math.round(Math.random()*50),to:1812+Math.round(Math.random()*50)},background:u[s%u.length],contrast:e[s%e.length],colors:angular.copy(f.colors),camera:{cameraHeight:0,targetHeight:0},circle:{position:new THREE.Vector3(0,0,0),texture:"img/rossini-01.png"},audio:s>0?{url:r[s%r.length],title:i[s%i.length],orchestra:"Academy of St Martin in the Fields Orchestra"}:null}})}function p(){var n=i.defer();return r.get("json/rossini.js").then(function(){var t=y();angular.forEach(t,function(n){n.titleTrusted=u.trustAsHtml(n.title);n.circle.position=(new THREE.Vector3).copy(n.circle.position);h.push(n)});l(0);n.resolve(h)},function(t){n.reject(t)}),n.promise}function a(){while(c.length){var n=c.pop();n.kill()}}function w(n,t,i,r){a();var u=new THREE.Color(t.colors.background),f=new THREE.Color(t.colors.lines),o=new THREE.Color(t.colors.overLines);c.push(TweenLite.to(e.values,i,{pow:n,cameraHeight:t.camera.cameraHeight,targetHeight:t.camera.targetHeight,delay:0,ease:Power2.easeInOut,onComplete:function(){r&&r()}}));c.push(TweenLite.to(e.values.background,i,{r:u.r,g:u.g,b:u.b,delay:0,ease:Power2.easeInOut,onUpdate:function(){var n=e.values.background.getHexString();document.body.style.backgroundColor="#"+n}}));c.push(TweenLite.to(e.values.lines,i,{r:f.r,g:f.g,b:f.b,delay:0,ease:Power2.easeInOut}));c.push(TweenLite.to(e.values.overLines,i,{r:o.r,g:o.g,b:o.b,delay:0,ease:Power2.easeInOut}))}function b(n){var t=e.current,i=h[t];w(t/h.length,i,n,function(){a()})}function l(i){t(function(){var r=e.current||0,t;e.current=i;t=h[i];e.step=t;o.colors.background=t.colors.background;o.colors.lines=t.colors.lines;o.colors.overLines=t.colors.overLines;o.camera.cameraHeight=t.camera.cameraHeight;o.camera.targetHeight=t.camera.targetHeight;o.circle.position.copy(t.circle.position);n.$broadcast("onStepChanged",{current:i,previous:r});b(e.duration)})}function k(){s++;s=Math.min(h.length-1,s);l(s);n.$broadcast("onGoStep",s)}function d(){s--;s=Math.max(0,s);l(s);n.$broadcast("onGoStep",s)}function g(){return h[s]}function nt(n){return h[n]}var e=this,o=f,s=0,h=[],c=[],v={pow:0,background:new THREE.Color(o.colors.background),lines:new THREE.Color(o.colors.lines),overLines:new THREE.Color(o.colors.overLines),cameraHeight:o.camera.cameraHeight,targetHeight:o.camera.targetHeight};n.$on("onOptionsChanged",function(){var t=e.current,n=h[t];e.values.cameraHeight=n.camera.cameraHeight;e.values.targetHeight=n.camera.targetHeight;e.values.background.copy(new THREE.Color(n.colors.background));e.values.lines.copy(new THREE.Color(n.colors.lines));e.values.overLines.copy(new THREE.Color(n.colors.overLines))});n.$on("onSlickBeforeChange",function(n,t){l(t.current)});this.init=p;this.values=v;this.duration=2.5;this.steps=h;this.current=s;this.next=k;this.previous=d;this.getCurrentStep=g;this.getStepAtIndex=nt}])}(),function(){"use strict";function i(n,t){for(var i,s,h,f=n*t,e=new Uint8Array(f),c=new r,u=1,l=Math.random()*100,o=0;o<4;o++){for(i=0;i<f;i++)s=i%n,h=~~(i/n),e[i]+=Math.abs(c.noise(s/u,h/u,l)*u*1.75);u*=5}return e}function r(){function u(n){return n*n*n*(n*(n*6-15)+10)}function i(n,t,i){return t+n*(i-t)}function t(n,t,i,r){var u=n&15,f=u<8?t:i,e=u<4?i:u==12||u==14?t:r;return((u&1)==0?f:-f)+((u&2)==0?e:-e)}for(var n=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],r=0;r<256;r++)n[256+r]=n[r];return{noise:function(r,f,e){var a=Math.floor(r),v=Math.floor(f),y=Math.floor(e),p=a&255,w=v&255,o=y&255;r-=a;f-=v;e-=y;var s=r-1,h=f-1,l=e-1,c=u(r),b=u(f),rt=u(e),k=n[p]+w,d=n[k]+o,g=n[k+1]+o,nt=n[p+1]+w,tt=n[nt]+o,it=n[nt+1]+o;return i(rt,i(b,i(c,t(n[d],r,f,e),t(n[tt],s,f,e)),i(c,t(n[g],r,h,e),t(n[it],s,h,e))),i(b,i(c,t(n[d+1],r,f,l),t(n[tt+1],s,f,e-1)),i(c,t(n[g+1],r,h,l),t(n[it+1],s,h,l))))}}}function n(n,t,i){var r=-1+Math.random()*2,u=Math.abs(r),f=i?Math.floor(r/u):1;return f*(n+(t-n)*u)}var t=angular.module("app");t.directive("scene",["SceneOptions","StepperService","AnalyserService",function(t,r,u){return{restrict:"A",scope:{data:"=scene"},link:function(f,e){function ut(){a=window.innerWidth;v=window.innerHeight;nt=a/2;tt=v/2;var n=a/v;l=new THREE.Scene;h=new THREE.PerspectiveCamera(30,n,.001,2e4);y=new THREE.WebGLRenderer({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0});y.setClearColor(0,0);y.setSize(a,v);p=new Stats;e[0].appendChild(y.domElement);e[0].appendChild(p.dom)}function ft(){c.ribbon=et();c.circles=new Array(o.steps).fill(null)}function et(){function a(){l.add(f)}function p(){l.remove(f)}function w(){var u=1/o.steps.length*.1,i=o.values.pow,f=(i+u).mod(1),e=o.getCurrentStep(),r=t.getPointAt(i),n;r.y+=o.values.cameraHeight;n=t.getPointAt(f);n.y+=o.values.targetHeight;h.position.copy(r);h.target.copy(n);h.lookAt(h.target)}var v=new THREE.Vector2(window.innerWidth,window.innerHeight),c=new MeshLineMaterial({color:o.values.lines,lineWidth:5,depthTest:!1,opacity:1,transparent:!0,near:1,far:1e3,blending:THREE.AdditiveBlending,resolution:v,sizeAttenuation:1}),r=new THREE.Vector3,y=new Array(s.ribbon.points).fill(null).map(function(){var t=(new THREE.Vector3).copy(r);return r.x+=n(500,1e3,!0),r.y+=n(10,40,!0),r.z+=n(1e3,2e3,!1),t}),i=new THREE.CatmullRomCurve3(y),t,u,e,f;return i.type="catmullrom",i.closed=!1,t=new THREE.CatmullRomCurve3(i.points.map(function(n){return new THREE.Vector3(n.x,n.y+20,n.z)})),t.type="catmullrom",t.closed=!1,u=new THREE.Geometry,u.vertices=i.getPoints(s.ribbon.vertices),e=new MeshLine,e.setGeometry(u),f=new THREE.Mesh(e.geometry,c),a(),h.target=h.target||new THREE.Vector3(0,0,0),{object:f,spline:i,cameraSpline:t,geometry:u,material:c,add:a,remove:p,update:w}}function ot(n){function wt(){console.log("objects.circles.add");l.add(r);t.adding=Date.now();t.removing=!1;t.enabled=!0;t.tween&&t.tween.kill();t.tween=TweenLite.to(t,2,{pow:1,delay:0,ease:Elastic.easeOut.config(1,.3),onComplete:function(){t.adding=!1}})}function bt(){console.log("objects.circles.remove");t.adding=!1;t.removing=Date.now();t.tween&&t.tween.kill();t.tween=TweenLite.to(t,.35,{pow:0,delay:0,ease:Power2.easeOut,onComplete:function(){t.removing=!1;t.enabled=!1;l.remove(r)}})}function dt(n,t){var r=new THREE.Geometry,f=ht(r,t,1),i,u;return rt.push(f),i=null,v?(u=new MeshLine,u.setGeometry(r),ot.push(r),ft.push(u),i=new THREE.Mesh(u.geometry,at)):i=new THREE.LineLoop(r,tt.clone()),y.add(i),i}function gt(n,t){var r=new THREE.Geometry,f=ht(r,t,2),i,u;return ut.push(f),i=null,v?(u=new MeshLine,u.setGeometry(r),st.push(r),et.push(u),i=new THREE.Mesh(u.geometry,vt)):i=new THREE.LineLoop(r,it.clone()),p.add(i),i}function ht(t,i,r){var f=new Array(u).fill(null).map(function(f,e){var a=e/u,o=360*a;o+=60*n;o+=30*r;o+=360/u*.1*i;var h=o*Math.PI/180,c=s.circle.radius,l=0;return l+=r===1?i*i*i*.005:i*i*i*.005,f=new THREE.Vector3,f.sincos={base:c,increment:l,radius:c,x:Math.cos(h),y:Math.sin(h)},t.vertices.push(f),f});return t.vertices.push(f[0]),f}function ct(n,t,i,r){var o=s.audioStrength,h=s.noiseStrength,c=s.circularStrength,e=d.data;angular.forEach(t,function(n,t){var l=s.audio.bands,b=t%l,d=(u-1-t)%l,a=e?(e[b]+e[d])/2/l:0,v=0,y=r===1?0:64,g=i*u+(t+y+v)%u,nt=i*u+(u-1-t-y+v)%u,p=(k[g]+k[nt])/128,w=1-(f-i)/f*c,tt=n.sincos.base+n.sincos.increment*p+n.sincos.increment*a+h*p*w+o*a*w+0;n.sincos.radius=tt;n.x=n.sincos.x*n.sincos.radius;n.y=n.sincos.y*n.sincos.radius;n.z=10*r});n.verticesNeedUpdate=!0}function ni(){var u,i;angular.forEach(yt,function(n,i){ct(n.geometry,rt[i],i,1);n.material.opacity=(0+1*i/f)*t.pow;v&&ft[i].setGeometry(ot[i])});angular.forEach(pt,function(n,i){ct(n.geometry,ut[i],i,2);n.material.opacity=(0+1*i/f)*t.pow;v&&et[i].setGeometry(st[i])});y.rotation.z+=.001;p.rotation.z-=.001;u=o.getStepAtIndex(n);e.position.copy(u.circle.position);i=c.ribbon.cameraSpline.getPointAt((n+.1)/o.steps.length);i.y+=o.values.targetHeight;r.position.copy(i);r.scale.x=r.scale.y=r.scale.z=.001+.14*t.pow;r.lookAt(h.position);nt.opacity=t.pow;tt.color=o.values.lines;it.color=o.values.overLines}var b,r,k=i(s.circle.points,s.circle.lines),f=s.circle.lines,u=s.circle.points,lt=o.steps[n],a=(new THREE.TextureLoader).load(lt.circle.texture),w,y,p,kt;a.wrapS=THREE.RepeatWrapping;a.wrapT=THREE.RepeatWrapping;a.repeat.set(1,1);var g=new THREE.Vector2(window.innerWidth,window.innerHeight),nt=new THREE.MeshBasicMaterial({color:16777215,map:a,transparent:!0}),tt=new THREE.LineBasicMaterial({color:o.values.lines,transparent:!0}),it=new THREE.LineBasicMaterial({color:o.values.overLines,transparent:!0}),at=new MeshLineMaterial({color:o.values.lines,lineWidth:1,depthTest:!1,opacity:1,transparent:!0,resolution:g}),vt=new MeshLineMaterial({color:o.values.overLines,lineWidth:1,depthTest:!1,opacity:1,transparent:!0,resolution:g});r=new THREE.Object3D;var rt=[],ut=[],ft=[],et=[],ot=[],st=[],v=!1,e=new THREE.Object3D;r.add(e);b=new THREE.PlaneGeometry(s.circle.radius*2-20,s.circle.radius*2-20,8,8);w=new THREE.Mesh(b,nt);w.position.z=-30;e.add(w);y=new THREE.Object3D;e.add(y);p=new THREE.Object3D;e.add(p);var yt=new Array(f).fill(null).map(dt),pt=new Array(f).fill(null).map(gt),t={pow:0,enabled:!1,adding:!1,removing:!1};return kt=0,{add:wt,remove:bt,object:r,state:t,update:ni}}function st(){d.update();it&&it.update();c.ribbon&&c.ribbon.update();angular.forEach(c.circles,function(n){n&&n.state.enabled&&n.update()});y.render(l,h)}function rt(){p.begin();st();p.end();requestAnimationFrame(rt)}function ht(){function n(){a=window.innerWidth;v=window.innerHeight;nt=a/2;tt=v/2;y.setSize(a,v);h.aspect=a/v;h.updateProjectionMatrix()}window.addEventListener("resize",n,!1)}var k=f.data;if(k){var c=k.objects,s=t,o=r,d=u,p,l,h,w,b,g,y,a,v,nt,tt,it=null;f.$on("onStepChanged",function(n,t){var r=null,i=t.current,u=t.previous;i>0&&(r=c.circles[i]||ot(i),r.add());c.circles[i]=r;setTimeout(function(){if(o.current!==u&&u>0){var n=c.circles[u];n&&n.remove()}},o.duration*1e3)});f.$on("onOptionsChanged",function(){});ut();ft();ht();rt()}}}}]);Number.prototype.mod=function(n){return(this%n+n)%n}}(),function(){"use strict";function i(){var n=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(n=!0)}(navigator.userAgent||navigator.vendor||window.opera),n}function r(){var n=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(n=!0)}(navigator.userAgent||navigator.vendor||window.opera),n}var t=angular.module("app"),u=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,f=i(),n=r();t.constant("SceneOptions",{colors:{background:15395048,lines:11845597,overLines:3363748},camera:{cameraHeight:0,targetHeight:5},ribbon:{steps:12,points:24,vertices:n?1200:2400},circle:{position:new THREE.Vector3,radius:200,lines:24,points:n?64:128},audio:{volume:.9,bands:n?64:128},audioStrength:100,noiseStrength:25,circularStrength:.9,device:{mobile:n,ios:u}})}();