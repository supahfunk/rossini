!function(){"use strict";angular.module("app",["ngRoute","ngSanitize","jsonFormatter"])}(),function(){"use strict";angular.module("app").config(["$httpProvider",function(e){}])}(),function(){"use strict";angular.module("app").config(["$locationProvider",function(e){e.html5Mode(!0),e.hashPrefix("")}])}(),function(){"use strict";angular.module("app").run(["$rootScope",function(e){}])}(),function(){"use strict";angular.module("app").factory("DatGui",["$rootScope","SceneOptions","StepperService",function(e,n,t){function o(){function o(n){var t=s.getCurrentStep();t.colors.background=i.colors.background,t.colors.lines=i.colors.lines,t.colors.overLines=i.colors.overLines,t.camera.cameraHeight=i.camera.cameraHeight,t.camera.targetHeight=i.camera.targetHeight,t.circle.position.copy(i.circle.position),e.$broadcast("onOptionsChanged")}function a(e){"a"===e.key.toLowerCase()&&e.ctrlKey&&$(document).find("body").toggleClass("gui-active")}var i=n,s=t,c=new dat.GUI;i.randomize=function(){for(var e=0;e<c.__controllers.length;e++){var n=c.__controllers[e];if(n.__min){var t=n.__min+(n.__max-n.__min)*Math.random();this[n.property]=t,n.updateDisplay()}n.__color&&(n.__color.r=Math.floor(255*Math.random()),n.__color.g=Math.floor(255*Math.random()),n.__color.b=Math.floor(255*Math.random()),n.updateDisplay(),n.setValue(n.__color.hex))}},i.saveJson=function(){console.log("saveJson"),r(s.steps,"rossini.js",!0,!0)},c.closed=!0,c.add(i.camera,"cameraHeight",-20,20).listen().onChange(o),c.add(i.camera,"targetHeight",-20,20).listen().onChange(o);var l=c.addFolder("circlePosition");l.add(i.circle.position,"x",-300,300).listen().onChange(o),l.add(i.circle.position,"y",-300,300).listen().onChange(o),l.add(i.circle.position,"z",-300,300).listen().onChange(o);var u=c.addFolder("colors");return u.addColor(i.colors,"background").listen().onChange(o),u.addColor(i.colors,"lines").listen().onChange(o),u.addColor(i.colors,"overLines").listen().onChange(o),c.add(i.audio,"volume",.01,1).onChange(o),c.add(i,"audioStrength",10,100).onChange(o),c.add(i,"noiseStrength",10,100).onChange(o),c.add(i,"circularStrength",.01,.9).onChange(o),c.add(i,"randomize"),c.add(i,"saveJson"),o(),angular.element(window).on("keydown",a),c}var r=function(){var e=document.createElement("a");return document.body.appendChild(e),e.style="display: none",function(n,t,o,r){o&&(n=r?JSON.stringify(n,null,2):JSON.stringify(n));var a=new Blob([n],{type:"octet/stream"}),i=window.URL.createObjectURL(a);e.href=i,e.download=t,e.click(),window.URL.revokeObjectURL(i)}}();return o}])}(),function(){"use strict";angular.module("app").directive("scrollbar",[function(){return{restrict:"A",link:function(e,n,t,o){function r(){var n=Scrollbar.init(a,i);e.$watch(n.contentEl.offsetHeight,function(e){n.update()})}var a=n[0],i={speed:1,damping:.1,overscrollDamping:1,thumbMinSize:20,continuousScrolling:!0,alwaysShowTracks:!1};setTimeout(r,100)}}}])}(),function(){"use strict";var e=angular.module("app");e.directive("slickBackgrounds",[function(){return{restrict:"A",link:function(e,n,t){function o(){n.hasClass("slick-initialized")&&n.slick("unslick")}function r(){o(),n.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,lazyLoad:"ondemand",cssEase:"cubic-bezier(0.7, 0, 0.3, 1)"})}e.$watchCollection(t.slickBackgrounds,function(e){e&&e.length&&r()}),e.$on("$destroy",function(){o()})}}}]),e.directive("slickTunnel",[function(){return{restrict:"A",link:function(e,n,t){function o(){n.hasClass("slick-initialized")&&n.slick("unslick")}function r(){o(),n.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,draggable:!1,asNavFor:".tunnel-bg",cssEase:"cubic-bezier(0.7, 0, 0.3, 1)"})}function a(){var e=$(".slick-active .splitted-letter");TweenMax.staggerTo(e,1,{delay:.2,y:0,x:0,ease:Power3.easeInOut,className:"+=viewed",onComplete:function(){$(".slick-active .cta").addClass("active")}},.009)}function i(n,t,o,r){u=!0;var a=$(".slick-active .splitted-letter");TweenMax.staggerTo(a,1,{delay:0,y:100,x:50,ease:Power3.easeInOut,className:"-=viewed"},.009),$(".slick-active .cta").removeClass("active"),e.$root.$broadcast("onSlickBeforeChange",{current:r,previouse:o})}function s(){u=!1;var n=$(".slick-active .splitted-letter");TweenMax.staggerTo(n,1,{delay:.2,y:0,x:0,ease:Power3.easeInOut,className:"+=viewed",onComplete:function(){$(".slick-active .cta").addClass("active")}},.009),e.$root.$broadcast("onAfterChange")}function c(e){u||(n.hasClass("slick-initialized")&&(e.deltaX>0||e.deltaY<0?n.slick("slickNext"):(e.deltaX<0||e.deltaY>0)&&n.slick("slickPrev")),e.preventDefault())}function l(){n.off("init",a).off("beforeChange",i).off("afterChange",s).off("mousewheel",c)}e.$watchCollection(t.slickTunnel,function(e){e&&e.length&&r()});var u=!1;e.$on("onGoStep",function(e,t){n.hasClass("slick-initialized")&&n.slick("slickGoTo",t)}),function(){n.on("init",a).on("beforeChange",i).on("afterChange",s).on("mousewheel",c)}(),e.$on("$destroy",function(){l(),o()})}}}])}(),function(){"use strict";angular.module("app").directive("splitText",[function(){return{restrict:"A",link:function(e,n,t){function o(){var e=n[0].childNodes;e=Array.prototype.slice.call(e,0),n.html("").addClass("active");var t=[[]];e.filter(function(e){return 3===e.nodeType||1===e.nodeType}).map(function(e){if(3===e.nodeType)e={text:$.trim(e.textContent),element:"span"};else{if("br"===e.nodeName.toLowerCase())return void t.push([]);e={text:$.trim(e.innerHTML),element:e.nodeName}}""!==e.text&&t[t.length-1].push(e)});for(var o=0;o<t.length;o++){var r=t[o];$('<div class="splitted-row"></div>').appendTo(n);for(var a=0;a<r.length;a++)for(var i=r[a],s=i.element.toLowerCase(),c=i.text,l=c.split(" "),u=0;u<l.length;u++){$("<"+s+' class="splitted-word"></'+s+">").appendTo($(".splitted-row:last"),n);for(var d=l[u],p=d.split(""),g=0;g<p.length;g++){var f=p[g];$('<span class="splitted-letter" data-content="'+f+'">'+f+"</span>").appendTo($(".splitted-word:last"),n)}$('<span class="splitted-space">&nbsp;</span>').appendTo($(".splitted-word:last"),n)}}}setTimeout(function(){o()},1)}}}])}(),function(){"use strict";angular.module("app").directive("yearsFrom",[function(){return{restrict:"A",scope:{from:"=yearsFrom",to:"=yearsTo"},link:function(e,n,t){function o(){function t(){o.html(parseInt(i.from)),r.html(parseInt(i.to))}var o=n.find(".tunnel-year__from"),r=n.find(".tunnel-year__to"),a=Power3.easeOut,i={from:o.html(),to:r.html()};e.to?(n.removeClass("one-year"),TweenLite.to(i,2,{to:e.to,roundProps:"year",onUpdate:t,ease:a})):(n.addClass("one-year"),TweenLite.to(i,2,{to:e.from,roundProps:"year",onUpdate:t,ease:a})),TweenLite.to(i,2,{from:e.from,roundProps:"year",onUpdate:t,ease:a})}e.$watch("from",function(e,n){e&&o()})}}}])}(),function(){"use strict";angular.module("app").controller("RootCtrl",["$scope","SceneOptions","StepperService","AnalyserService","DatGui",function(e,n,t,o,r){var a={objects:{},options:n,stepper:t},i=a.stepper;i.init().then(function(){e.scene=a,e.stepper=i,e.audio=o,new r})}])}(),function(){"use strict";angular.module("app").service("AnalyserService",["$rootScope","$q","$http","SceneOptions","StepperService",function(e,n,t,o,r){function a(){if(!T){var e;T=b.createMediaElementSource(h),T.connect(f),T.connect(b.destination),f.fftSize=2*w.audio.bands,e=f.frequencyBinCount,m.data=new Uint8Array(e)}return m.data}function i(e){v!==e&&(v=e,h.src=e,h.volume=w.audio.volume)}function s(){h&&h.play()}function c(){h&&h.pause()}function l(){h&&(m.active=!m.active,m.active?h.play():h.pause())}function u(){i(y.getCurrentStep().audio.url)}function d(){m.data&&f.getByteFrequencyData(m.data)}function p(e){var t=n.defer();return!H||m.unlocked?t.resolve():(g(e),$timeout(function(){T.playbackState!==T.PLAYING_STATE&&T.playbackState!==T.FINISHED_STATE||(m.unlocked=!0,t.resolve())})),console.log("AudioAnalyser.unlock"),t.promise}function g(e){var n=myContext.createBuffer(1,1,22050),t=myContext.createBufferSource();t.buffer=n,t.connect(myContext.destination),t.noteOn(0),console.log("AudioAnalyser.doUnlock")}var f,h,v,m=this,w=o,y=r,E=window.AudioContext||window.webkitAudioContext,b=new E;f=b.createAnalyser(),h=new Audio,h.addEventListener("canplay",a);var T=null,H=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;m.unlocked=!1,window.addEventListener("touchstart",p,!1),e.$on("onStepChanged",function(e){u()}),e.$on("onOptionsChanged",function(e){h&&(h.volume=w.audio.volume)}),this.active=!0,this.data=null,this.audio=h,this.update=d,this.play=s,this.pause=c,this.toggle=l,this.unlock=p}])}(),function(){"use strict";angular.module("app").service("StepperService",["$rootScope","$timeout","$q","$http","$sce","SceneOptions",function(e,n,t,o,r,a){function i(){var e=["Il periodo francese:<br> la nascita della <em>Grand Op√©ra</em>","Il Barbiere di Siviglia<br> al teatro Argentina<br> di Roma","Il Silenzio"],n=["Il giovane Gioacchino","Il folgorante debutto","La frenesia della produzione","Sulle strade di Parigi"],t=["Il Barbiere di Siviglia","L'italiana in Algeri"],o=["audio/07-rossini-192.mp3","audio/08-rossini-192.mp3"],r=["img/tunnel-1.jpg","img/tunnel-2.jpg","img/tunnel-3.jpg"],i=["light-bg","light-bg","dark-bg"];return new Array(m.ribbon.steps).fill().map(function(s,c){return{id:c+1,title:e[c%e.length],chapter:"Passione, Genio e Silenzio",paragraph:n[Math.floor(c/3)%n.length],years:{from:1812+Math.round(50*Math.random()),to:1812+Math.round(50*Math.random())},background:r[c%r.length],contrast:i[c%i.length],colors:angular.copy(a.colors),camera:{cameraHeight:0,targetHeight:0},circle:{position:new THREE.Vector3(0,0,0),texture:"img/rossini-01.png"},audio:{url:o[c%o.length],title:t[c%t.length],orchestra:"Academy of St Martin in the Fields Orchestra"}}})}function s(){var e=t.defer();return o.get("json/rossini.js").then(function(n){var t=i();angular.forEach(t,function(e){e.titleTrusted=r.trustAsHtml(e.title),e.circle.position=(new THREE.Vector3).copy(e.circle.position),y.push(e)}),d(0),e.resolve(y)},function(n){e.reject(n)}),e.promise}function c(){for(;E.length;)E.pop().kill()}function l(e,n,t,o){c();var r=new THREE.Color(n.colors.background),a=new THREE.Color(n.colors.lines),i=new THREE.Color(n.colors.overLines);E.push(TweenLite.to(v.values,t,{pow:e,cameraHeight:n.camera.cameraHeight,targetHeight:n.camera.targetHeight,delay:0,ease:Power2.easeInOut,onComplete:function(){o&&o()}})),E.push(TweenLite.to(v.values.background,t,{r:r.r,g:r.g,b:r.b,delay:0,ease:Power2.easeInOut,onUpdate:function(){var e=v.values.background.getHexString();document.body.style.backgroundColor="#"+e}})),E.push(TweenLite.to(v.values.lines,t,{r:a.r,g:a.g,b:a.b,delay:0,ease:Power2.easeInOut})),E.push(TweenLite.to(v.values.overLines,t,{r:i.r,g:i.g,b:i.b,delay:0,ease:Power2.easeInOut}))}function u(e){var n=v.current,t=y[n];l(n/y.length,t,e,function(){c()})}function d(t){n(function(){var n=v.current||0;v.current=t;var o=y[t];v.step=o,m.colors.background=o.colors.background,m.colors.lines=o.colors.lines,m.colors.overLines=o.colors.overLines,m.camera.cameraHeight=o.camera.cameraHeight,m.camera.targetHeight=o.camera.targetHeight,m.circle.position.copy(o.circle.position),e.$broadcast("onStepChanged",{current:t,previous:n}),u(v.duration)})}function p(){w++,w=Math.min(y.length-1,w),d(w),e.$broadcast("onGoStep",w)}function g(){w--,w=Math.max(0,w),d(w),e.$broadcast("onGoStep",w)}function f(){return y[w]}function h(e){return y[e]}var v=this,m=a,w=0,y=[],E=[],b={pow:0,background:new THREE.Color(m.colors.background),lines:new THREE.Color(m.colors.lines),overLines:new THREE.Color(m.colors.overLines),cameraHeight:m.camera.cameraHeight,targetHeight:m.camera.targetHeight};e.$on("onOptionsChanged",function(){var e=v.current,n=y[e];v.values.cameraHeight=n.camera.cameraHeight,v.values.targetHeight=n.camera.targetHeight,v.values.background.copy(new THREE.Color(n.colors.background)),v.values.lines.copy(new THREE.Color(n.colors.lines)),v.values.overLines.copy(new THREE.Color(n.colors.overLines))}),e.$on("onSlickBeforeChange",function(e,n){d(n.current)}),this.init=s,this.values=b,this.duration=2.5,this.steps=y,this.current=w,this.next=p,this.previous=g,this.getCurrentStep=f,this.getStepAtIndex=h}])}(),function(){"use strict";function e(e,t){for(var o=e*t,r=new Uint8Array(o),a=new n,i=1,s=100*Math.random(),c=0;c<4;c++){for(var l=0;l<o;l++){var u=l%e,d=~~(l/e);r[l]+=Math.abs(a.noise(u/i,d/i,s)*i*1.75)}i*=5}return r}function n(){function e(e){return e*e*e*(e*(6*e-15)+10)}function n(e,n,t){return n+e*(t-n)}function t(e,n,t,o){var r=15&e,a=r<8?n:t,i=r<4?t:12==r||14==r?n:o;return(0==(1&r)?a:-a)+(0==(2&r)?i:-i)}for(var o=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],r=0;r<256;r++)o[256+r]=o[r];return{noise:function(r,a,i){var s=Math.floor(r),c=Math.floor(a),l=Math.floor(i),u=255&s,d=255&c,p=255&l;r-=s,a-=c,i-=l;var g=r-1,f=a-1,h=i-1,v=e(r),m=e(a),w=e(i),y=o[u]+d,E=o[y]+p,b=o[y+1]+p,T=o[u+1]+d,H=o[T]+p,C=o[T+1]+p;return n(w,n(m,n(v,t(o[E],r,a,i),t(o[H],g,a,i)),n(v,t(o[b],r,f,i),t(o[C],g,f,i))),n(m,n(v,t(o[E+1],r,a,h),t(o[H+1],g,a,i-1)),n(v,t(o[b+1],r,f,h),t(o[C+1],g,f,h))))}}}function t(e,n,t){var o=2*Math.random()-1,r=Math.abs(o);return(t?Math.floor(o/r):1)*(e+(n-e)*r)}angular.module("app").directive("scene",["SceneOptions","StepperService","AnalyserService",function(n,o,r){return{restrict:"A",scope:{data:"=scene"},link:function(a,i,s){function c(){function e(){f.add(p)}function n(){f.remove(p)}function o(){var e=1/H.steps.length*.1,n=H.values.pow,t=(n+e).mod(1),o=(H.getCurrentStep(),l.getPointAt(n));o.y+=H.values.cameraHeight;var r=l.getPointAt(t);r.y+=H.values.targetHeight,h.position.copy(o),h.target.copy(r),h.lookAt(h.target)}var r=new THREE.Vector2(window.innerWidth,window.innerHeight),a=new MeshLineMaterial({color:H.values.lines,lineWidth:5,depthTest:!1,opacity:1,transparent:!0,near:1,far:1e3,blending:THREE.AdditiveBlending,resolution:r,sizeAttenuation:1}),i=new THREE.Vector3,s=new Array(T.ribbon.points).fill(null).map(function(){var e=(new THREE.Vector3).copy(i);return i.x+=t(500,1e3,!0),i.y+=t(5,20,!0),i.z+=t(1e3,2e3,!1),e}),c=new THREE.CatmullRomCurve3(s);c.type="catmullrom",c.closed=!1;var l=new THREE.CatmullRomCurve3(c.points.map(function(e){return new THREE.Vector3(e.x,e.y+20,e.z)}));l.type="catmullrom",l.closed=!1;var u=new THREE.Geometry;u.vertices=c.getPoints(T.ribbon.vertices);var d=new MeshLine;d.setGeometry(u);var p=new THREE.Mesh(d.geometry,a);return e(),h.target=h.target||new THREE.Vector3(0,0,0),{object:p,spline:c,cameraSpline:l,geometry:u,material:a,add:e,remove:n,update:o}}function l(n){function t(){console.log("objects.circles.add"),f.add(u),D.adding=Date.now(),D.removing=!1,D.enabled=!0,D.tween&&D.tween.kill(),D.tween=TweenLite.to(D,D.duration,{pow:1,delay:0,ease:Elastic.easeOut.config(1,.3),onComplete:function(){D.adding=!1}})}function o(){console.log("objects.circles.remove"),D.adding=!1,D.removing=Date.now(),D.tween&&D.tween.kill(),D.tween=TweenLite.to(D,D.duration,{pow:0,delay:0,ease:Power2.easeOut,onComplete:function(){D.removing=!1,D.enabled=!1,f.remove(u)}})}function r(e,n){var t=new THREE.Geometry,o=i(t,n,1);L.push(o);var r=null;if(P){var a=new MeshLine;a.setGeometry(t),x.push(t),M.push(a),r=new THREE.Mesh(a.geometry,k)}else r=new THREE.LineLoop(t,E.clone());return I.add(r),r}function a(e,n){var t=new THREE.Geometry,o=i(t,n,2);$.push(o);var r=null;if(P){var a=new MeshLine;a.setGeometry(t),O.push(t),A.push(a),r=new THREE.Mesh(a.geometry,R)}else r=new THREE.LineLoop(t,S.clone());return j.add(r),r}function i(e,t,o){var r=new Array(g).fill(null).map(function(r,a){var i=a/g,s=360*i;s+=60*n,s+=30*o,s+=360/g*.1*t;var c=s*Math.PI/180,l=T.circle.radius,u=0;return u+=t*t*t*.005,r=new THREE.Vector3,r.sincos={base:l,increment:u,radius:l,x:Math.cos(c),y:Math.sin(c)},e.vertices.push(r),r});return e.vertices.push(r[0]),r}function s(e,n,t,o){var r=T.audioStrength,a=T.noiseStrength,i=T.circularStrength,s=C.data;angular.forEach(n,function(e,n){var c=T.audio.bands,l=n%c,u=(g-1-n)%c,f=s?(s[l]+s[u])/2/c:0,h=1===o?0:64,v=t*g+(n+h+0)%g,m=t*g+(g-1-n-h+0)%g,w=(d[v]+d[m])/2/64,y=1-(p-t)/p*i,E=e.sincos.base+e.sincos.increment*w+e.sincos.increment*f+a*w*y+r*f*y+0;e.sincos.radius=E,e.x=e.sincos.x*e.sincos.radius,e.y=e.sincos.y*e.sincos.radius,e.z=10*o}),e.verticesNeedUpdate=!0}function c(){angular.forEach(G,function(e,n){s(e.geometry,L[n],n,1),e.material.opacity=(0+1*n/p)*D.pow,P&&M[n].setGeometry(x[n])}),angular.forEach(B,function(e,n){s(e.geometry,$[n],n,2),e.material.opacity=(0+1*n/p)*D.pow,P&&A[n].setGeometry(O[n])}),I.rotation.z+=.001,j.rotation.z-=.001;var e=H.getStepAtIndex(n);_.position.copy(e.circle.position);var t=b.ribbon.cameraSpline.getPointAt((n+.1)/H.steps.length);t.y+=H.values.targetHeight,u.position.copy(t),u.scale.x=u.scale.y=u.scale.z=.001+.14*D.pow,u.lookAt(h.position),y.opacity=D.pow,E.color=H.values.lines,S.color=H.values.overLines}var l,u,d=e(T.circle.points,T.circle.lines),p=T.circle.lines,g=T.circle.points,v=H.steps[n],m=(new THREE.TextureLoader).load(v.circle.texture);m.wrapS=THREE.RepeatWrapping,m.wrapT=THREE.RepeatWrapping,m.repeat.set(1,1);var w=new THREE.Vector2(window.innerWidth,window.innerHeight),y=new THREE.MeshBasicMaterial({color:16777215,map:m,transparent:!0}),E=new THREE.LineBasicMaterial({color:H.values.lines,transparent:!0}),S=new THREE.LineBasicMaterial({color:H.values.overLines,transparent:!0}),k=new MeshLineMaterial({color:H.values.lines,lineWidth:1,depthTest:!1,opacity:1,transparent:!0,resolution:w}),R=new MeshLineMaterial({color:H.values.overLines,lineWidth:1,depthTest:!1,opacity:1,transparent:!0,resolution:w});u=new THREE.Object3D;var L=[],$=[],M=[],A=[],x=[],O=[],P=!1,_=new THREE.Object3D;u.add(_),l=new THREE.PlaneGeometry(2*T.circle.radius-20,2*T.circle.radius-20,8,8);var z=new THREE.Mesh(l,y);z.position.z=-30,_.add(z);var I=new THREE.Object3D;_.add(I);var j=new THREE.Object3D;_.add(j);var G=new Array(p).fill(null).map(r),B=new Array(p).fill(null).map(a),D={pow:0,duration:2.35,enabled:!1,adding:!1,removing:!1};return{add:t,remove:o,object:u,state:D,update:c}}function u(){C.update(),S&&S.update(),b.ribbon&&b.ribbon.update(),angular.forEach(b.circles,function(e){e&&e.state.enabled&&e.update()}),v.render(f,h)}function d(){g.begin(),u(),g.end(),requestAnimationFrame(d)}var p=a.data;if(p){var g,f,h,v,m,w,y,E,b=p.objects,T=n,H=o,C=r,S=null;a.$on("onStepChanged",function(e,n){var t=null,o=n.current,r=n.previous;o>0&&(t=b.circles[o]||l(o),t.add()),b.circles[o]=t,setTimeout(function(){if(H.current!==r&&r>0){var e=b.circles[r];e&&e.remove()}},1e3*H.duration)}),a.$on("onOptionsChanged",function(e){}),function(){m=window.innerWidth,w=window.innerHeight,y=m/2,E=w/2;var e=m/w;f=new THREE.Scene,h=new THREE.PerspectiveCamera(30,e,.001,2e4),v=new THREE.WebGLRenderer({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0}),v.setClearColor(0,0),v.setSize(m,w),g=new Stats,i[0].appendChild(v.domElement),i[0].appendChild(g.dom)}(),function(){b.ribbon=c(),b.circles=new Array(H.steps).fill(null)}(),function(){function e(){m=window.innerWidth,w=window.innerHeight,y=m/2,E=w/2,v.setSize(m,w),h.aspect=m/w,h.updateProjectionMatrix()}window.addEventListener("resize",e,!1)}(),d()}}}}]),Number.prototype.mod=function(e){return(this%e+e)%e}}(),function(){"use strict";angular.module("app").constant("SceneOptions",{colors:{background:15395048,lines:11845597,overLines:3363748},camera:{cameraHeight:0,targetHeight:5},ribbon:{steps:12,points:24,vertices:2400},circle:{position:new THREE.Vector3,radius:200,lines:24,points:128},audio:{volume:.9,bands:128},audioStrength:100,noiseStrength:25,circularStrength:.9})}();
//# sourceMappingURL=app.min.js.map
