<<<<<<< HEAD
!function(){"use strict";angular.module("app",["ngSilent","ngRoute","ngSanitize","jsonFormatter"])}(),function(){"use strict";angular.module("app").config(["$httpProvider",function(e){}])}(),function(){"use strict";angular.module("app").config(["$locationProvider","$routeProvider",function(e,n){e.html5Mode(!1),e.hashPrefix(""),n.when("/years/",{templateUrl:function(){return"partials/years.html"},controller:"YearsCtrl",controllerAs:"yearsCtrl"}).when("/years/:yearsKey",{templateUrl:function(){return"partials/years.html"},controller:"YearsCtrl",controllerAs:"yearsCtrl"}).when("/years/:yearsKey/detail",{templateUrl:function(){return"partials/years.html"},controller:"YearsCtrl",controllerAs:"yearsCtrl"}),n.otherwise("/years")}])}(),function(){"use strict";angular.module("app").run(["$rootScope",function(e){}])}(),function(){"use strict";angular.module("app").factory("DatGui",["$rootScope","SceneOptions","StepperService",function(e,n,t){function o(){function o(n){var t=c.getCurrentStep();t.colors.background=a.colors.background,t.colors.lines=a.colors.lines,t.colors.overLines=a.colors.overLines,t.camera.cameraHeight=a.camera.cameraHeight,t.camera.targetHeight=a.camera.targetHeight,t.circle.position.copy(a.circle.position),e.$broadcast("onOptionsChanged")}function r(e){"a"===e.key.toLowerCase()&&e.ctrlKey&&$(document).find("body").toggleClass("gui-active")}var a=n,c=t,s=new dat.GUI;a.randomize=function(){function e(e){for(var n=0;n<e.length;n++){var t=e[n];if(t.__min){var o=t.__min+(t.__max-t.__min)*Math.random();t.setValue(o),t.updateDisplay()}t.__color&&(t.__color.r=Math.floor(255*Math.random()),t.__color.g=Math.floor(255*Math.random()),t.__color.b=Math.floor(255*Math.random()),t.updateDisplay(),t.setValue(t.__color.hex))}}e(s.__controllers),angular.forEach(s.__folders,function(n){e(n.__controllers)})},a.saveJson=function(){var e=c.steps.map(function(e){e=angular.copy(e);var n={background:"#"+new THREE.Color(e.colors.background).getHexString(),lines:"#"+new THREE.Color(e.colors.lines).getHexString(),overLines:"#"+new THREE.Color(e.colors.overLines).getHexString()};return e.colors=n,e});console.log("saveJson",e),i(e,"rossini.js",!0,!0)},s.closed=!0,s.add(a.camera,"cameraHeight",-10,30).listen().onChange(o),s.add(a.camera,"targetHeight",-10,30).listen().onChange(o);var l=s.addFolder("circlePosition");l.add(a.circle.position,"x",-300,300).listen().onChange(o),l.add(a.circle.position,"y",-300,300).listen().onChange(o),l.add(a.circle.position,"z",-300,300).listen().onChange(o);var u=s.addFolder("colors");return u.addColor(a.colors,"background").listen().onChange(o),u.addColor(a.colors,"lines").listen().onChange(o),u.addColor(a.colors,"overLines").listen().onChange(o),s.add(a.audio,"volume",.01,1).onChange(o),s.add(a,"audioStrength",10,100).onChange(o),s.add(a,"noiseStrength",10,100).onChange(o),s.add(a,"circularStrength",.01,.9).onChange(o),s.add(a,"randomize"),s.add(a,"saveJson"),o(),angular.element(window).on("keydown",r),s}var i=function(){var e=document.createElement("a");return document.body.appendChild(e),e.style="display: none",function(n,t,o,i){o&&(n=i?JSON.stringify(n,null,2):JSON.stringify(n));var r=new Blob([n],{type:"octet/stream"}),a=window.URL.createObjectURL(r);e.href=a,e.download=t,e.click(),window.URL.revokeObjectURL(a)}}();return o}])}(),function(){"use strict";angular.module("app").directive("scrollbar",[function(){return{restrict:"A",link:function(e,n,t,o){function i(){var n=Scrollbar.init(r,a);e.$watch(n.contentEl.offsetHeight,function(e){n.update()})}var r=n[0],a={speed:1,damping:.1,overscrollDamping:1,thumbMinSize:20,continuousScrolling:!0,alwaysShowTracks:!1};setTimeout(i,100)}}}])}(),function(){"use strict";var e=angular.module("app");e.directive("slickTunnel",["$timeout","StepperService","SceneOptions",function(e,n,t){return{restrict:"A",link:function(o,i,r){function a(){i.hasClass("slick-initialized")&&i.slick("unslick")}function c(){a(),i.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,draggable:!1,asNavFor:f.useBackground?".tunnel-bg":null,cssEase:"cubic-bezier(0.7, 0, 0.3, 1)",initialSlide:h.current})}function s(){var e=$(".slick-active .splitted-letter");TweenMax.staggerTo(e,1,{delay:.2,y:0,x:0,ease:Power3.easeInOut,className:"+=viewed",onComplete:function(){$(".slick-active .cta").addClass("active")}},.009)}function l(){var e=$(".slick-active .splitted-letter");TweenMax.staggerTo(e,1,{delay:0,y:100,x:50,ease:Power3.easeInOut,className:"-=viewed"},.009),$(".slick-active .cta").removeClass("active")}function u(){e(function(){s()},1e3),o.$root.$broadcast("onSlickInit")}function d(e,n,t,i){h.slicking=!0,l(),o.$root.$broadcast("onSlickBeforeChange",{current:i,previouse:t})}function p(e,n,t){h.slicking=!1,s(),o.$root.$broadcast("onSlickAfterChange",{current:t})}function g(e){h.slicking||(i.hasClass("slick-initialized")&&(e.deltaX>0||e.deltaY<0?i.slick("slickNext"):(e.deltaX<0||e.deltaY>0)&&i.slick("slickPrev")),e.preventDefault())}function m(){i.off("init",u).off("beforeChange",d).off("afterChange",p).off("mousewheel",g)}var f=t,h=n;!function(){i.on("init",u).on("beforeChange",d).on("afterChange",p).on("mousewheel",g)}(),o.$watchCollection(r.slickTunnel,function(e){e&&e.length&&c()}),o.$on("onGoStep",function(e,n){i.hasClass("slick-initialized")&&i.slick("slickGoTo",n)}),o.$on("$destroy",function(){m(),a()})}}}]),e.directive("slickBackgrounds",[function(){return{restrict:"A",link:function(e,n,t){function o(){n.hasClass("slick-initialized")&&n.slick("unslick")}function i(){o(),n.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,lazyLoad:"ondemand",cssEase:"cubic-bezier(0.7, 0, 0.3, 1)"})}e.$watchCollection(t.slickBackgrounds,function(e){e&&e.length&&setTimeout(i,1)}),e.$on("$destroy",function(){o()})}}}])}(),function(){"use strict";angular.module("app").directive("splitText",[function(){return{restrict:"A",link:function(e,n,t){function o(){var e=n[0].childNodes;e=Array.prototype.slice.call(e,0),n.html("").addClass("active");var t=[[]];e.filter(function(e){return 3===e.nodeType||1===e.nodeType}).map(function(e){if(3===e.nodeType)e={text:$.trim(e.textContent),element:"span"};else{if("br"===e.nodeName.toLowerCase())return void t.push([]);e={text:$.trim(e.innerHTML),element:e.nodeName}}""!==e.text&&t[t.length-1].push(e)});for(var o=0;o<t.length;o++){var i=t[o];$('<div class="splitted-row"></div>').appendTo(n);for(var r=0;r<i.length;r++)for(var a=i[r],c=a.element.toLowerCase(),s=a.text,l=s.split(" "),u=0;u<l.length;u++){$("<"+c+' class="splitted-word"></'+c+">").appendTo($(".splitted-row:last"),n);for(var d=l[u],p=d.split(""),g=0;g<p.length;g++){var m=p[g];$('<span class="splitted-letter" data-content="'+m+'">'+m+"</span>").appendTo($(".splitted-word:last"),n)}$('<span class="splitted-space">&nbsp;</span>').appendTo($(".splitted-word:last"),n)}}}setTimeout(function(){o()},1)}}}])}(),function(){"use strict";angular.module("app").directive("yearsFrom",[function(){return{restrict:"A",scope:{from:"=yearsFrom",to:"=yearsTo"},link:function(e,n,t){function o(){function t(){o.html(parseInt(a.from)),i.html(parseInt(a.to))}var o=n.find(".tunnel-year__from"),i=n.find(".tunnel-year__to"),r=Power3.easeOut,a={from:o.html(),to:i.html()};e.to?(n.removeClass("one-year"),TweenLite.to(a,2,{to:e.to,roundProps:"year",onUpdate:t,ease:r})):(n.addClass("one-year"),TweenLite.to(a,2,{to:e.from,roundProps:"year",onUpdate:t,ease:r})),TweenLite.to(a,2,{from:e.from,roundProps:"year",onUpdate:t,ease:r})}e.$watch("from",function(e,n){e&&o()})}}}])}(),function(){"use strict";angular.module("app").controller("YearsCtrl",["$scope","$route","$routeParams","$ngSilentLocation","SceneOptions","StepperService","AnalyserService","DatGui","$timeout",function(e,n,t,o,i,r,a,c,s){function l(){return o.silent(p.step.detailUrl),g.active=!0,!1}function u(){return o.silent(p.step.url),g.active=!1,!1}var d={objects:{},options:i,stepper:r},p=d.stepper;p.init(t.yearsKey).then(function(){e.scene=d,e.stepper=p,e.audio=a,-1!==n.current.$$route.originalPath.indexOf("/detail")&&s(function(){l()}),new c});var g={};e.detail=g,e.openDetail=l,e.closeDetail=u,e.$on("onStepChanged",function(){o.silent(p.step.url)})}])}(),function(){"use strict";angular.module("app").service("AnalyserService",["$rootScope","$timeout","$q","$http","SceneOptions","StepperService",function(e,n,t,o,i,r){function a(){if(!$){var e;$=x.createMediaElementSource(k),$.smoothingTimeConstant=.85,$.connect(b),$.connect(x.destination),b.fftSize=2*S.audio.bands,e=b.frequencyBinCount,H.data=new Uint8Array(e)}}function c(){n(function(){H.playing=!0})}function s(){n(function(){H.playing=!1})}function l(){n(function(){H.playing=!1})}function u(e){E!==e&&(E=e)&&(k.src=e,k.volume=S.audio.volume,d())}function d(){H.active&&E&&!m()&&k.play()}function p(){E&&m()&&k.pause()}function g(){return H.active&&m()}function m(){return!k.paused&&!k.ended}function f(){H.active=!H.active,H.active?d():p()}function h(){var e=T.getCurrentStep();u(e.audio?e.audio.url:null)}function v(){H.data&&b.getByteFrequencyData(H.data)}function w(){var e=t.defer();return!S.device.ios||H.unlocked?e.resolve():($=y(),n(function(){$.playbackState!==$.PLAYING_STATE&&$.playbackState!==$.FINISHED_STATE||(H.unlocked=!0,e.resolve())})),console.log("AudioAnalyser.unlock"),e.promise}function y(){var e=new C,n=e.createBufferSource(),t=e.createBuffer(1,1,22050);return n.buffer=t,n.connect(e.destination),n.noteOn&&n.noteOn(0),console.log("AudioAnalyser.doUnlock"),n}var b,k,E,H=this,S=i,T=r,C=window.AudioContext||window.webkitAudioContext,x=new C;b=x.createAnalyser(),k=new Audio,k.addEventListener("canplay",a),k.addEventListener("play",c),k.addEventListener("pause",s),k.addEventListener("ended",l);var $=null;H.unlocked=!1,window.addEventListener("touchstart",w,!1),e.$on("onStepChanged",function(e){h()}),e.$on("onOptionsChanged",function(e){k.volume=S.audio.volume}),this.active=!0,this.data=null,this.audio=k,this.update=v,this.play=d,this.pause=p,this.toggle=f,this.unlock=w,this.isPlaying=m,this.isActive=g}])}(),function(){"use strict";angular.module("app").service("StepperService",["$rootScope","$timeout","$q","$http","$sce","SceneOptions",function(e,n,t,o,i,r){function a(){var e=["Il periodo francese:<br> la nascita della <em>Grand Opéra</em>","Il Barbiere di Siviglia<br> al teatro Argentina<br> di Roma","Il Silenzio"],n=["Il giovane Gioacchino","Il folgorante debutto","La frenesia della produzione","Sulle strade di Parigi"],t=["Il Barbiere di Siviglia","L'italiana in Algeri"],o=["audio/07-rossini-192.mp3","audio/08-rossini-192.mp3"],i=["img/tunnel-1.jpg","img/tunnel-2.jpg","img/tunnel-3.jpg"],a=["light-bg","light-bg","dark-bg"];return new Array(v.ribbon.steps).fill().map(function(c,s){var l={id:s+1,title:e[s%e.length],url:"view.html",chapter:"Passione, Genio e Silenzio",paragraph:n[Math.floor(s/3)%n.length],years:s%4==0?{from:1812+Math.round(50*Math.random())}:{from:1812+Math.round(50*Math.random()),to:1812+Math.round(50*Math.random())},background:i[s%i.length],contrast:a[s%a.length],colors:angular.copy(r.colors),camera:{cameraHeight:-10,targetHeight:30},circle:{position:new THREE.Vector3(0,0,0),texture:"img/rossini-01.png"},audio:s>0?{url:o[s%o.length],title:t[s%t.length],orchestra:"Academy of St Martin in the Fields Orchestra"}:null};return"dark-bg"===l.contrast&&(l.colors.background=1118481),l})}function c(e){var n=t.defer();return o.get("json/rossini.js").then(function(t){var o=0,r=a();angular.forEach(r,function(n,t){n.years.key=String(t+1),n.url="/years/"+n.years.key,n.detailUrl=n.url+"/detail",n.years.key===e&&(o=t),n.titleTrusted=i.trustAsHtml(n.title),n.circle.position=(new THREE.Vector3).copy(n.circle.position),y.push(n)}),k.pow=o/y.length,h.current=w=o,d(o),n.resolve(y)},function(e){n.reject(e)}),n.promise}function s(){for(;b.length;)b.pop().kill()}function l(e,n,t,o){s();var i=new THREE.Color(n.colors.background),r=new THREE.Color(n.colors.lines),a=new THREE.Color(n.colors.overLines);b.push(TweenLite.to(h.values,t,{pow:e,cameraHeight:n.camera.cameraHeight,targetHeight:n.camera.targetHeight,delay:0,ease:Power2.easeInOut,onComplete:function(){o&&o()}})),b.push(TweenLite.to(h.values.background,t,{r:i.r,g:i.g,b:i.b,delay:0,ease:Power2.easeInOut})),b.push(TweenLite.to(h.values.lines,t,{r:r.r,g:r.g,b:r.b,delay:0,ease:Power2.easeInOut})),b.push(TweenLite.to(h.values.overLines,t,{r:a.r,g:a.g,b:a.b,delay:0,ease:Power2.easeInOut}))}function u(e){var n=h.current,t=y[n];l(n/y.length,t,e,function(){s()})}function d(t){n(function(){var n=h.current||0;h.current=w=t;var o=y[t];if(h.step=o,v.colors.background=o.colors.background,v.colors.lines=o.colors.lines,v.colors.overLines=o.colors.overLines,v.camera.cameraHeight=o.camera.cameraHeight,v.camera.targetHeight=o.camera.targetHeight,v.circle.position.copy(o.circle.position),!v.useBackground){var i=new THREE.Color(v.colors.background).getHexString();$(".tunnel-gradient").css("background-color","#"+i)}e.$broadcast("onStepChanged",{current:t,previous:n}),u(h.duration)})}function p(){return y[w]}function g(e){return y[e]}function m(){h.slicking||(w--,w=Math.max(0,w),d(w),e.$broadcast("onGoStep",w))}function f(){h.slicking||(w++,w=Math.min(y.length-1,w),d(w),e.$broadcast("onGoStep",w))}var h=this,v=r,w=0,y=[],b=[],k={pow:0,background:new THREE.Color(v.colors.background),lines:new THREE.Color(v.colors.lines),overLines:new THREE.Color(v.colors.overLines),cameraHeight:v.camera.cameraHeight,targetHeight:v.camera.targetHeight};e.$on("onOptionsChanged",function(){var e=h.current,n=y[e];if(h.values.cameraHeight=n.camera.cameraHeight,h.values.targetHeight=n.camera.targetHeight,h.values.background.copy(new THREE.Color(n.colors.background)),h.values.lines.copy(new THREE.Color(n.colors.lines)),h.values.overLines.copy(new THREE.Color(n.colors.overLines)),!v.useBackground){var t=h.values.background.getHexString();$(".tunnel-gradient").css("background-color","#"+t)}}),e.$on("onSlickBeforeChange",function(e,n){d(n.current)}),this.init=c,this.values=k,this.duration=2.5,this.steps=y,this.getCurrentStep=p,this.getStepAtIndex=g,this.current=w,this.previous=m,this.next=f}])}(),function(){"use strict";function e(e,t){for(var o=e*t,i=new Uint8Array(o),r=new n,a=1,c=100*Math.random(),s=0;s<4;s++){for(var l=0;l<o;l++){var u=l%e,d=~~(l/e);i[l]+=Math.abs(r.noise(u/a,d/a,c)*a*1.75)}a*=5}return i}function n(){function e(e){return e*e*e*(e*(6*e-15)+10)}function n(e,n,t){return n+e*(t-n)}function t(e,n,t,o){var i=15&e,r=i<8?n:t,a=i<4?t:12==i||14==i?n:o;return(0==(1&i)?r:-r)+(0==(2&i)?a:-a)}for(var o=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],i=0;i<256;i++)o[256+i]=o[i];return{noise:function(i,r,a){var c=Math.floor(i),s=Math.floor(r),l=Math.floor(a),u=255&c,d=255&s,p=255&l;i-=c,r-=s,a-=l;var g=i-1,m=r-1,f=a-1,h=e(i),v=e(r),w=e(a),y=o[u]+d,b=o[y]+p,k=o[y+1]+p,E=o[u+1]+d,H=o[E]+p,S=o[E+1]+p;return n(w,n(v,n(h,t(o[b],i,r,a),t(o[H],g,r,a)),n(h,t(o[k],i,m,a),t(o[S],g,m,a))),n(v,n(h,t(o[b+1],i,r,f),t(o[H+1],g,r,a-1)),n(h,t(o[k+1],i,m,f),t(o[S+1],g,m,f))))}}}function t(e,n,t){var o=2*Math.random()-1,i=Math.abs(o);return(t?Math.floor(o/i):1)*(e+(n-e)*i)}angular.module("app").directive("scene",["SceneOptions","StepperService","AnalyserService",function(n,o,i){return{restrict:"A",scope:{data:"=scene"},link:function(r,a,c){function s(){$.x=20*x.x+10*Math.cos($.i/100),$.y=20*x.y+10*Math.sin($.i/100),$.i++}function l(){function e(){f.add(p)}function n(){f.remove(p)}function o(){var e=1/S.steps.length,n=.1*e,t=S.values.pow,o=(t+n).mod(1),i=(S.getCurrentStep(),l.getPointAt(t));i.y+=S.values.cameraHeight,p.material.uniforms.visibility.value=Math.min(1,S.values.pow+e);var r=l.getPointAt(o);r.y+=S.values.targetHeight,h.position.copy(i),h.target.copy(r),h.position.x+=(i.x+$.x-h.position.x)/12,h.position.y+=(i.y+$.y-h.position.y)/12,h.lookAt(h.target)}var i=new THREE.Vector2(window.innerWidth,window.innerHeight),r=new MeshLineMaterial({color:S.values.lines,lineWidth:5,opacity:.8,transparent:!0,depthTest:!1,sizeAttenuation:!0,resolution:i,near:h.near,far:h.far}),a=new THREE.Vector3,c=new Array(H.ribbon.points).fill(null).map(function(){var e=(new THREE.Vector3).copy(a);return a.x+=t(500,1e3,!0),a.y+=t(10,40,!0),a.z+=t(1e3,2e3,!1),e}),s=new THREE.CatmullRomCurve3(c);s.type="catmullrom",s.closed=!1;var l=new THREE.CatmullRomCurve3(s.points.map(function(e){return new THREE.Vector3(e.x,e.y+20,e.z)}));l.type="catmullrom",l.closed=!1;var u=new THREE.Geometry;u.vertices=s.getPoints(H.ribbon.vertices);var d=new MeshLine;d.setGeometry(u);var p=new THREE.Mesh(d.geometry,r);return e(),h.target=h.target||new THREE.Vector3(0,0,0),{object:p,spline:s,cameraSpline:l,geometry:u,material:r,add:e,remove:n,update:o}}function u(n){function t(){f.add(u),N.adding=Date.now(),N.removing=!1,N.enabled=!0,N.tween&&N.tween.kill(),N.tween=TweenLite.to(N,2,{pow:1,delay:0,ease:Elastic.easeOut.config(1,.3),onComplete:function(){N.adding=!1}})}function o(){N.adding=!1,N.removing=Date.now(),N.tween&&N.tween.kill(),N.tween=TweenLite.to(N,.35,{pow:0,delay:0,ease:Power2.easeOut,onComplete:function(){N.removing=!1,N.enabled=!1,f.remove(u)}})}function i(e,n){var t=new THREE.Geometry,o=a(t,n,1);M.push(o);var i=null;if(j){var r=new MeshLine;r.setGeometry(t),P.push(t),z.push(r),i=new THREE.Mesh(r.geometry,L)}else i=new THREE.LineLoop(t,C.clone());return B.add(i),i}function r(e,n){var t=new THREE.Geometry,o=a(t,n,2);A.push(o);var i=null;if(j){var r=new MeshLine;r.setGeometry(t),_.push(t),O.push(r),i=new THREE.Mesh(r.geometry,R)}else i=new THREE.LineLoop(t,x.clone());return D.add(i),i}function a(e,t,o){var i=new Array(m).fill(null).map(function(i,r){var a=r/m,c=360*a;c+=60*n,c+=30*o,c+=360/m*.1*t;var s=c*Math.PI/180,l=H.circle.radius,u=0;return u+=t*t*t*.005,i=new THREE.Vector3,i.sincos={base:l,increment:u,radius:l,x:Math.cos(s),y:Math.sin(s)},e.vertices.push(i),i});return e.vertices.push(i[0]),i}function c(e,n,t,o){var i=H.audioStrength,r=H.noiseStrength,a=H.circularStrength,c=1===o?d:p,s=T.data;angular.forEach(n,function(e,n){var l=H.audio.bands,u=n%l,d=(m-1-n)%l,p=s?(s[u]+s[d])/2/l:0,f=1===o?0:64,h=t*m+(n+f+0)%m,v=t*m+(m-1-n-f+0)%m,w=(c[h]+c[v])/2/64,y=1-(g-t)/g*a,b=e.sincos.base+e.sincos.increment*w+e.sincos.increment*p+r*w*y+i*p*y+0;e.sincos.radius=b,e.x=e.sincos.x*e.sincos.radius,e.y=e.sincos.y*e.sincos.radius,e.z=10*o+.01*t}),e.verticesNeedUpdate=!0}function s(){k.opacity=N.pow,angular.forEach(U,function(e,n){c(e.geometry,M[n],n,1),e.material.opacity=(0+1*n/g)*N.pow,e.material.color=S.values.lines,j&&z[n].setGeometry(P[n])}),angular.forEach(q,function(e,n){c(e.geometry,A[n],n,2),e.material.opacity=(0+1*n/g)*N.pow,e.material.color=S.values.overLines,j&&O[n].setGeometry(_[n])}),B.rotation.z+=.001,D.rotation.z-=.001,w>1023?I.position.copy(v.circle.position):I.position.copy(V),I.rotation.x+=(.00625*$.y-I.rotation.x)/12,I.rotation.y+=(.0125*$.x-I.rotation.y)/12;var e=E.ribbon.cameraSpline.getPointAt((n+.1)/S.steps.length);e.y+=S.values.targetHeight,u.position.copy(e),u.scale.x=u.scale.y=u.scale.z=.001+.14*N.pow,u.lookAt(h.position)}var l,u,d=e(H.circle.points,H.circle.lines),p=e(H.circle.points,H.circle.lines),g=H.circle.lines,m=H.circle.points,v=S.getStepAtIndex(n),y=(new THREE.TextureLoader).load(v.circle.texture);y.wrapS=THREE.RepeatWrapping,y.wrapT=THREE.RepeatWrapping,y.repeat.set(1,1);var b=new THREE.Vector2(window.innerWidth,window.innerHeight),k=new THREE.MeshBasicMaterial({color:16777215,map:y,transparent:!0}),C=new THREE.LineBasicMaterial({color:S.values.lines,transparent:!0}),x=new THREE.LineBasicMaterial({color:S.values.overLines,transparent:!0}),L=new MeshLineMaterial({color:S.values.lines,lineWidth:1,depthTest:!1,opacity:1,transparent:!0,resolution:b,near:h.near,far:h.far}),R=new MeshLineMaterial({color:S.values.overLines,lineWidth:1,depthTest:!1,opacity:1,transparent:!0,resolution:b,near:h.near,far:h.far});u=new THREE.Object3D;var M=[],A=[],z=[],O=[],P=[],_=[],j=!1,I=new THREE.Object3D;u.add(I),l=new THREE.PlaneGeometry(2*H.circle.radius-20,2*H.circle.radius-20,8,8);var G=new THREE.Mesh(l,k);G.position.z=-30,I.add(G);var B=new THREE.Object3D;I.add(B);var D=new THREE.Object3D;I.add(D);var U=new Array(g).fill(null).map(i),q=new Array(g).fill(null).map(r),N={pow:0,enabled:!1,adding:!1,removing:!1},V=new THREE.Vector3(0,100,0);return{add:t,remove:o,object:u,state:N,update:s}}function d(){s(),T.update(),C&&C.update(),E.ribbon&&E.ribbon.update(),angular.forEach(E.circles,function(e){e&&e.state.enabled&&e.update()}),v.render(f,h)}function p(){m.begin(),d(),m.end(),requestAnimationFrame(p)}var g=r.data;if(g){var m,f,h,v,w,y,b,k,E=g.objects,H=n,S=o,T=i,C=null;r.$on("onStepChanged",function(e,n){var t=null,o=n.current,i=n.previous;o>0&&(t=E.circles[o]||u(o),t.add()),E.circles[o]=t,setTimeout(function(){if(S.current!==i&&i>0){var e=E.circles[i];e&&e.remove()}},1e3*S.duration)}),r.$on("onOptionsChanged",function(e){});var x={x:0,y:0},$={x:0,y:0,i:0};!function(){w=window.innerWidth,y=window.innerHeight,b=w/2,k=y/2;var e=w/y;f=new THREE.Scene,h=new THREE.PerspectiveCamera(30,e,.001,2e4),v=new THREE.WebGLRenderer({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0}),v.setClearColor(0,0),v.setSize(w,y),v.sortObjects=!1,m=new Stats,a[0].appendChild(v.domElement),a[0].appendChild(m.dom)}(),function(){E.ribbon=l(),E.circles=new Array(S.steps).fill(null)}(),function(){function e(){w=window.innerWidth,y=window.innerHeight,b=w/2,k=y/2,v.setSize(w,y),h.aspect=w/y,h.updateProjectionMatrix()}function n(e){var n=window.innerWidth/2,t=window.innerHeight/2;x.x=(e.clientX-n)/n,x.y=(e.clientY-t)/t}window.addEventListener("resize",e,!1),document.addEventListener("mousemove",n,!1)}(),p()}}}}]),Number.prototype.mod=function(e){return(this%e+e)%e}}(),function(){"use strict";var e=angular.module("app"),n=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,t=(function(){var e=!1;(function(n){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4)))&&(e=!0)})(navigator.userAgent||navigator.vendor||window.opera)}(),function(){var e=!1;return function(n){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}());e.constant("SceneOptions",{colors:{background:15395048,lines:11845597,overLines:3363748},camera:{cameraHeight:-10,targetHeight:30},ribbon:{steps:12,points:24,vertices:t?1200:2400},circle:{position:new THREE.Vector3,radius:200,lines:24,points:t?64:128},audio:{volume:.9,bands:t?64:128},audioStrength:100,noiseStrength:25,circularStrength:.9,useBackground:!1,device:{mobile:t,ios:n}})}();
//# sourceMappingURL=app.min.js.map
=======
(function(){"use strict";var n=angular.module("app",["ngRoute","ngSanitize","jsonFormatter"])})(),function(){"use strict";var n=angular.module("app");n.config(["$httpProvider",function(){}])}(),function(){"use strict";var n=angular.module("app");n.config(["$locationProvider",function(n){n.html5Mode(!0);n.hashPrefix("")}])}(),function(){"use strict";var n=angular.module("app");n.run(["$rootScope",function(){}])}(),function(){"use strict";var n=angular.module("app");n.factory("DatGui",["$rootScope","SceneOptions","StepperService",function(n,t,i){function u(){function e(){var t=h.getCurrentStep();t.colors.background=u.colors.background;t.colors.lines=u.colors.lines;t.colors.overLines=u.colors.overLines;t.camera.cameraHeight=u.camera.cameraHeight;t.camera.targetHeight=u.camera.targetHeight;t.circle.position.copy(u.circle.position);n.$broadcast("onOptionsChanged")}function c(n){var t=n.key.toLowerCase();t==="a"&&n.ctrlKey&&$(document).find("body").toggleClass("gui-active")}var u=t,h=i,f=new dat.GUI,o,s;u.randomize=function(){function n(n){for(var t,r,i=0;i<n.length;i++)t=n[i],t.__min&&(r=t.__min+(t.__max-t.__min)*Math.random(),t.setValue(r),t.updateDisplay()),t.__color&&(t.__color.r=Math.floor(Math.random()*255),t.__color.g=Math.floor(Math.random()*255),t.__color.b=Math.floor(Math.random()*255),t.updateDisplay(),t.setValue(t.__color.hex))}n(f.__controllers);angular.forEach(f.__folders,function(t){n(t.__controllers)})};u.saveJson=function(){var n=h.steps.map(function(n){n=angular.copy(n);var t={background:"#"+new THREE.Color(n.colors.background).getHexString(),lines:"#"+new THREE.Color(n.colors.lines).getHexString(),overLines:"#"+new THREE.Color(n.colors.overLines).getHexString()};return n.colors=t,n});console.log("saveJson",n);r(n,"rossini.js",!0,!0)};f.closed=!0;f.add(u.camera,"cameraHeight",-10,30).listen().onChange(e);f.add(u.camera,"targetHeight",-10,30).listen().onChange(e);o=f.addFolder("circlePosition");o.add(u.circle.position,"x",-300,300).listen().onChange(e);o.add(u.circle.position,"y",-300,300).listen().onChange(e);o.add(u.circle.position,"z",-300,300).listen().onChange(e);s=f.addFolder("colors");s.addColor(u.colors,"background").listen().onChange(e);s.addColor(u.colors,"lines").listen().onChange(e);s.addColor(u.colors,"overLines").listen().onChange(e);f.add(u.audio,"volume",.01,1).onChange(e);f.add(u,"audioStrength",10,100).onChange(e);f.add(u,"noiseStrength",10,100).onChange(e);f.add(u,"circularStrength",.01,.9).onChange(e);f.add(u,"randomize");f.add(u,"saveJson");e();angular.element(window).on("keydown",c);return f}var r=function(){var n=document.createElement("a");return document.body.appendChild(n),n.style="display: none",function(t,i,r,u){r&&(t=u?JSON.stringify(t,null,2):JSON.stringify(t));var e=new Blob([t],{type:"octet/stream"}),f=window.URL.createObjectURL(e);n.href=f;n.download=i;n.click();window.URL.revokeObjectURL(f)}}();return u}])}(),function(){"use strict";var n=angular.module("app");n.directive("scrollbar",[function(){return{restrict:"A",link:function(n,t){function u(){var t=Scrollbar.init(i,r);n.$watch(t.contentEl.offsetHeight,function(){t.update()})}var i=t[0],r={speed:1,damping:.1,overscrollDamping:1,thumbMinSize:20,continuousScrolling:!0,alwaysShowTracks:!1};setTimeout(u,100)}}}])}(),function(){"use strict";var n=angular.module("app");n.directive("slickTunnel",["StepperService","SceneOptions",function(n,t){return{restrict:"A",link:function(i,r,u){function e(){r.hasClass("slick-initialized")&&r.slick("unslick")}function v(){e();r.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,draggable:!1,asNavFor:a.useBackground?".tunnel-bg":null,cssEase:"cubic-bezier(0.7, 0, 0.3, 1)"})}function o(){var n=$(".slick-active .splitted-letter");TweenMax.staggerTo(n,1,{delay:.2,y:0,x:0,ease:Power3.easeInOut,className:"+=viewed",onComplete:function(){$(".slick-active .cta").addClass("active")}},.009)}function y(){var n=$(".slick-active .splitted-letter");TweenMax.staggerTo(n,1,{delay:0,y:100,x:50,ease:Power3.easeInOut,className:"-=viewed"},.009);$(".slick-active .cta").removeClass("active")}function s(){o();i.$root.$broadcast("onSlickInit",{current:0})}function h(n,t,r,u){f.slicking=!0;y();i.$root.$broadcast("onSlickBeforeChange",{current:u,previouse:r})}function c(n,t,r){f.slicking=!1;o();i.$root.$broadcast("onSlickAfterChange",{current:r})}function l(n){f.slicking||(r.hasClass("slick-initialized")&&(n.deltaX>0||n.deltaY<0?r.slick("slickNext"):(n.deltaX<0||n.deltaY>0)&&r.slick("slickPrev")),n.preventDefault())}function p(){r.on("init",s).on("beforeChange",h).on("afterChange",c).on("mousewheel",l)}function w(){r.off("init",s).off("beforeChange",h).off("afterChange",c).off("mousewheel",l)}var a=t,f=n;p();i.$watchCollection(u.slickTunnel,function(n){n&&n.length&&v()});i.$on("onGoStep",function(n,t){r.hasClass("slick-initialized")&&r.slick("slickGoTo",t)});i.$on("$destroy",function(){w();e()})}}}]);n.directive("slickBackgrounds",[function(){return{restrict:"A",link:function(n,t,i){function r(){t.hasClass("slick-initialized")&&t.slick("unslick")}function u(){r();t.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,lazyLoad:"ondemand",cssEase:"cubic-bezier(0.7, 0, 0.3, 1)"})}n.$watchCollection(i.slickBackgrounds,function(n){n&&n.length&&setTimeout(u,1)});n.$on("$destroy",function(){r()})}}}])}(),function(){"use strict";var n=angular.module("app");n.directive("splitText",[function(){return{restrict:"A",link:function(n,t){function i(){var e=t[0].childNodes,n,i,o,r,u,v,s,f,h;for(e=Array.prototype.slice.call(e,0),t.html("").addClass("active"),n=[[]],e.filter(function(n){return n.nodeType===3||n.nodeType===1}).map(function(t){if(t.nodeType===3)t={text:$.trim(t.textContent),element:"span"};else{if(t.nodeName.toLowerCase()==="br"){n.push([]);return}t={text:$.trim(t.innerHTML),element:t.nodeName}}t.text!==""&&n[n.length-1].push(t)}),i=0;i<n.length;i++)for(o=n[i],$('<div class="splitted-row"><\/div>').appendTo(t),r=0;r<o.length;r++){var c=o[r],l=c.element.toLowerCase(),y=c.text,a=y.split(" ");for(u=0;u<a.length;u++){for($("<"+l+' class="splitted-word"><\/'+l+">").appendTo($(".splitted-row:last"),t),v=a[u],s=v.split(""),f=0;f<s.length;f++)h=s[f],$('<span class="splitted-letter" data-content="'+h+'">'+h+"<\/span>").appendTo($(".splitted-word:last"),t);$('<span class="splitted-space">&nbsp;<\/span>').appendTo($(".splitted-word:last"),t)}}}setTimeout(function(){i()},1)}}}])}(),function(){"use strict";var n=angular.module("app");n.directive("yearsFrom",[function(){return{restrict:"A",scope:{from:"=yearsFrom",to:"=yearsTo"},link:function(n,t){function i(){function f(){e.html(parseInt(i.from));o.html(parseInt(i.to))}var e=t.find(".tunnel-year__from"),o=t.find(".tunnel-year__to"),r=2,u=Power3.easeOut,i={from:e.html(),to:o.html()};n.to?(t.removeClass("one-year"),TweenLite.to(i,r,{to:n.to,roundProps:"year",onUpdate:f,ease:u})):(t.addClass("one-year"),TweenLite.to(i,r,{to:n.from,roundProps:"year",onUpdate:f,ease:u}));TweenLite.to(i,r,{from:n.from,roundProps:"year",onUpdate:f,ease:u})}n.$watch("from",function(n){n&&i()})}}}])}(),function(){"use strict";var n=angular.module("app");n.controller("RootCtrl",["$scope","SceneOptions","StepperService","AnalyserService","DatGui","$timeout",function(n,t,i,r,u,f){var e={objects:{},options:t,stepper:i},h=e.objects,c=e.options,s=e.stepper,o;s.init().then(function(){n.scene=e;n.stepper=s;n.audio=r;var t=new u});o={};n.openDetail=function(){return $.get(s.step.url,function(n){f(function(){o.active=!0;o.html=n})}),!1};n.detail=o;console.log("RootCtrl",t)}])}(),function(){"use strict";var n=angular.module("app");n.service("AnalyserService",["$rootScope","$timeout","$q","$http","SceneOptions","StepperService",function(n,t,i,r,u,f){function d(){if(!s){var n;s=v.createMediaElementSource(o);s.smoothingTimeConstant=.85;s.connect(h);s.connect(v.destination);h.fftSize=a.audio.bands*2;n=h.frequencyBinCount;e.data=new Uint8Array(n)}}function g(){t(function(){e.playing=!0;console.log("AnalyserService.onPlay",e)})}function nt(){t(function(){e.playing=!1;console.log("AnalyserService.onPause",e)})}function tt(){t(function(){e.playing=!1;console.log("AnalyserService.onEnded",e)})}function it(n){c!==n&&(c=n,c&&(o.src=n,o.volume=a.audio.volume,y()))}function y(){e.active&&c&&!l()&&o.play()}function w(){c&&l()&&o.pause()}function rt(){return console.log("isActive",e.active,l()),e.active&&l()}function l(){return!o.paused&&!o.ended}function ut(){e.active=!e.active;e.active?y():w()}function ft(){var n=k.getCurrentStep();it(n.audio?n.audio.url:null)}function et(){e.data&&h.getByteFrequencyData(e.data)}function b(){var n=i.defer();return!a.device.ios||e.unlocked?n.resolve():(s=ot(),t(function(){(s.playbackState===s.PLAYING_STATE||s.playbackState===s.FINISHED_STATE)&&(e.unlocked=!0,n.resolve())})),console.log("AudioAnalyser.unlock"),n.promise}function ot(){var t=new p,n=t.createBufferSource(),i=t.createBuffer(1,1,22050);return n.buffer=i,n.connect(t.destination),n.noteOn&&n.noteOn(0),console.log("AudioAnalyser.doUnlock"),n}var e=this,a=u,k=f,h,o,c,p=window.AudioContext||window.webkitAudioContext,v=new p,s;h=v.createAnalyser();o=new Audio;o.addEventListener("canplay",d);o.addEventListener("play",g);o.addEventListener("pause",nt);o.addEventListener("ended",tt);s=null;e.unlocked=!1;window.addEventListener("touchstart",b,!1);n.$on("onStepChanged",function(){ft()});n.$on("onOptionsChanged",function(){o.volume=a.audio.volume});this.active=!0;this.data=null;this.audio=o;this.update=et;this.play=y;this.pause=w;this.toggle=ut;this.unlock=b;this.isPlaying=l;this.isActive=rt}])}(),function(){"use strict";var n=angular.module("app");n.service("StepperService",["$rootScope","$timeout","$q","$http","$sce","SceneOptions",function(n,t,i,r,u,f){function y(){var n=["Il periodo francese:<br> la nascita della <em>Grand Opéra<\/em>","Il Barbiere di Siviglia<br> al teatro Argentina<br> di Roma","Il Silenzio",],t=["Il giovane Gioacchino","Il folgorante debutto","La frenesia della produzione","Sulle strade di Parigi",],i=["Il Barbiere di Siviglia","L'italiana in Algeri",],r=["audio/07-rossini-192.mp3","audio/08-rossini-192.mp3",],u=["img/tunnel-1.jpg","img/tunnel-2.jpg","img/tunnel-3.jpg",],e=["light-bg","light-bg","dark-bg",];return new Array(o.ribbon.steps).fill().map(function(o,s){var h={id:s+1,title:n[s%n.length],url:"view.html",chapter:"Passione, Genio e Silenzio",paragraph:t[Math.floor(s/3)%t.length],years:s%4==0?{from:1812+Math.round(Math.random()*50)}:{from:1812+Math.round(Math.random()*50),to:1812+Math.round(Math.random()*50)},background:u[s%u.length],contrast:e[s%e.length],colors:angular.copy(f.colors),camera:{cameraHeight:-10,targetHeight:30},circle:{position:new THREE.Vector3(0,0,0),texture:"img/rossini-01.png"},audio:s>0?{url:r[s%r.length],title:i[s%i.length],orchestra:"Academy of St Martin in the Fields Orchestra"}:null};return h.contrast==="dark-bg"&&(h.colors.background=1118481),h})}function p(){var n=i.defer();return r.get("json/rossini.js").then(function(){var t=y();angular.forEach(t,function(n){n.titleTrusted=u.trustAsHtml(n.title);n.circle.position=(new THREE.Vector3).copy(n.circle.position);h.push(n)});l(0);n.resolve(h)},function(t){n.reject(t)}),n.promise}function a(){while(c.length){var n=c.pop();n.kill()}}function w(n,t,i,r){a();var u=new THREE.Color(t.colors.background),f=new THREE.Color(t.colors.lines),o=new THREE.Color(t.colors.overLines);c.push(TweenLite.to(e.values,i,{pow:n,cameraHeight:t.camera.cameraHeight,targetHeight:t.camera.targetHeight,delay:0,ease:Power2.easeInOut,onComplete:function(){r&&r()}}));c.push(TweenLite.to(e.values.background,i,{r:u.r,g:u.g,b:u.b,delay:0,ease:Power2.easeInOut}));c.push(TweenLite.to(e.values.lines,i,{r:f.r,g:f.g,b:f.b,delay:0,ease:Power2.easeInOut}));c.push(TweenLite.to(e.values.overLines,i,{r:o.r,g:o.g,b:o.b,delay:0,ease:Power2.easeInOut}))}function b(n){var t=e.current,i=h[t];w(t/h.length,i,n,function(){a()})}function k(i){console.log("setStep");t(function(){var u=e.current||0,t,r;e.current=s=i;t=h[i];e.step=t;o.colors.background=t.colors.background;o.colors.lines=t.colors.lines;o.colors.overLines=t.colors.overLines;o.camera.cameraHeight=t.camera.cameraHeight;o.camera.targetHeight=t.camera.targetHeight;o.circle.position.copy(t.circle.position);o.useBackground||(r=new THREE.Color(o.colors.background).getHexString(),$(".tunnel-gradient").css("background-color","#"+r));n.$broadcast("onStepChanged",{current:i,previous:u});b(e.duration)})}function d(){return h[s]}function g(n){return h[n]}function nt(){e.slicking||(s--,s=Math.max(0,s),l(s),n.$broadcast("onGoStep",s))}function tt(){e.slicking||(s++,s=Math.min(h.length-1,s),l(s),n.$broadcast("onGoStep",s))}function l(i){console.log("cambio pagina");k(i);n.$broadcast("onGoStep",i);t(function(){var t=$(".tunnel-nav__step.active"),n=t.position().top,i=t.width()+16;$(".tunnel-nav__follower").css({width:i+"px","-webkit-transform":"translateY("+n+"px)","-moz-transform":"translateY("+n+"px)","-ms-transform":"translateY("+n+"px)",transform:"translateY("+n+"px)"})})}var e=this,o=f,s=0,h=[],c=[],v={pow:0,background:new THREE.Color(o.colors.background),lines:new THREE.Color(o.colors.lines),overLines:new THREE.Color(o.colors.overLines),cameraHeight:o.camera.cameraHeight,targetHeight:o.camera.targetHeight};n.$on("onOptionsChanged",function(){var i=e.current,n=h[i],t;e.values.cameraHeight=n.camera.cameraHeight;e.values.targetHeight=n.camera.targetHeight;e.values.background.copy(new THREE.Color(n.colors.background));e.values.lines.copy(new THREE.Color(n.colors.lines));e.values.overLines.copy(new THREE.Color(n.colors.overLines));o.useBackground||(t=e.values.background.getHexString(),$(".tunnel-gradient").css("background-color","#"+t))});n.$on("onSlickBeforeChange",function(n,t){l(t.current)});this.init=p;this.values=v;this.duration=2.5;this.steps=h;this.navStep=l;this.getCurrentStep=d;this.getStepAtIndex=g;this.current=s;this.previous=nt;this.next=tt}])}(),function(){"use strict";function t(n,t){for(var i,s,h,f=n*t,e=new Uint8Array(f),c=new r,u=1,l=Math.random()*100,o=0;o<4;o++){for(i=0;i<f;i++)s=i%n,h=~~(i/n),e[i]+=Math.abs(c.noise(s/u,h/u,l)*u*1.75);u*=5}return e}function r(){function u(n){return n*n*n*(n*(n*6-15)+10)}function i(n,t,i){return t+n*(i-t)}function t(n,t,i,r){var u=n&15,f=u<8?t:i,e=u<4?i:u==12||u==14?t:r;return((u&1)==0?f:-f)+((u&2)==0?e:-e)}for(var n=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],r=0;r<256;r++)n[256+r]=n[r];return{noise:function(r,f,e){var a=Math.floor(r),v=Math.floor(f),y=Math.floor(e),p=a&255,w=v&255,o=y&255;r-=a;f-=v;e-=y;var s=r-1,h=f-1,l=e-1,c=u(r),b=u(f),rt=u(e),k=n[p]+w,d=n[k]+o,g=n[k+1]+o,nt=n[p+1]+w,tt=n[nt]+o,it=n[nt+1]+o;return i(rt,i(b,i(c,t(n[d],r,f,e),t(n[tt],s,f,e)),i(c,t(n[g],r,h,e),t(n[it],s,h,e))),i(b,i(c,t(n[d+1],r,f,l),t(n[tt+1],s,f,e-1)),i(c,t(n[g+1],r,h,l),t(n[it+1],s,h,l))))}}}function n(n,t,i){var r=-1+Math.random()*2,u=Math.abs(r),f=i?Math.floor(r/u):1;return f*(n+(t-n)*u)}var i=angular.module("app");i.directive("scene",["SceneOptions","StepperService","AnalyserService",function(i,r,u){return{restrict:"A",scope:{data:"=scene"},link:function(f,e){function et(){c.x=w.x*20+Math.cos(c.i/100)*10;c.y=w.y*20+Math.sin(c.i/100)*10;c.i++}function ot(){v=window.innerWidth;y=window.innerHeight;it=v/2;rt=y/2;var n=v/y;a=new THREE.Scene;o=new THREE.PerspectiveCamera(30,n,.001,2e4);p=new THREE.WebGLRenderer({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0});p.setClearColor(0,0);p.setSize(v,y);p.sortObjects=!1;b=new Stats;e[0].appendChild(p.domElement);e[0].appendChild(b.dom)}function st(){l.ribbon=ht();l.circles=new Array(s.steps).fill(null)}function ht(){function v(){a.add(r)}function w(){a.remove(r)}function b(){var u=1/s.steps.length,e=u*.1,f=s.values.pow,h=(f+e).mod(1),l=s.getCurrentStep(),n=t.getPointAt(f),i;n.y+=s.values.cameraHeight;r.material.uniforms.visibility.value=Math.min(1,s.values.pow+u);i=t.getPointAt(h);i.y+=s.values.targetHeight;o.position.copy(n);o.target.copy(i);o.position.x+=(n.x+c.x-o.position.x)/12;o.position.y+=(n.y+c.y-o.position.y)/12;o.lookAt(o.target)}var y=new THREE.Vector2(window.innerWidth,window.innerHeight),l=new MeshLineMaterial({color:s.values.lines,lineWidth:5,opacity:.8,transparent:!0,depthTest:!1,sizeAttenuation:!0,resolution:y,near:o.near,far:o.far}),u=new THREE.Vector3,p=new Array(h.ribbon.points).fill(null).map(function(){var t=(new THREE.Vector3).copy(u);return u.x+=n(500,1e3,!0),u.y+=n(10,40,!0),u.z+=n(1e3,2e3,!1),t}),i=new THREE.CatmullRomCurve3(p),t,f,e,r;return i.type="catmullrom",i.closed=!1,t=new THREE.CatmullRomCurve3(i.points.map(function(n){return new THREE.Vector3(n.x,n.y+20,n.z)})),t.type="catmullrom",t.closed=!1,f=new THREE.Geometry,f.vertices=i.getPoints(h.ribbon.vertices),e=new MeshLine,e.setGeometry(f),r=new THREE.Mesh(e.geometry,l),v(),o.target=o.target||new THREE.Vector3(0,0,0),{object:r,spline:i,cameraSpline:t,geometry:f,material:l,add:v,remove:w,update:b}}function ct(n){function gt(){a.add(r);i.adding=Date.now();i.removing=!1;i.enabled=!0;i.tween&&i.tween.kill();i.tween=TweenLite.to(i,2,{pow:1,delay:0,ease:Elastic.easeOut.config(1,.3),onComplete:function(){i.adding=!1}})}function ni(){i.adding=!1;i.removing=Date.now();i.tween&&i.tween.kill();i.tween=TweenLite.to(i,.35,{pow:0,delay:0,ease:Power2.easeOut,onComplete:function(){i.removing=!1;i.enabled=!1;a.remove(r)}})}function ii(n,t){var r=new THREE.Geometry,f=ht(r,t,1),i,u;return rt.push(f),i=null,p?(u=new MeshLine,u.setGeometry(r),ot.push(r),ft.push(u),i=new THREE.Mesh(u.geometry,wt)):i=new THREE.LineLoop(r,yt.clone()),w.add(i),i}function ri(n,t){var r=new THREE.Geometry,f=ht(r,t,2),i,u;return ut.push(f),i=null,p?(u=new MeshLine,u.setGeometry(r),st.push(r),et.push(u),i=new THREE.Mesh(u.geometry,bt)):i=new THREE.LineLoop(r,pt.clone()),b.add(i),i}function ht(t,i,r){var u=new Array(f).fill(null).map(function(u,e){var a=e/f,o=360*a;o+=60*n;o+=30*r;o+=360/f*.1*i;var s=o*Math.PI/180,c=h.circle.radius,l=0;return l+=r===1?i*i*i*.005:i*i*i*.005,u=new THREE.Vector3,u.sincos={base:c,increment:l,radius:c,x:Math.cos(s),y:Math.sin(s)},t.vertices.push(u),u});return t.vertices.push(u[0]),u}function ct(n,t,i,r){var s=h.audioStrength,c=h.noiseStrength,l=h.circularStrength,o=r===1?at:vt,u=nt.data;angular.forEach(t,function(n,t){var a=h.audio.bands,k=t%a,d=(f-1-t)%a,v=u?(u[k]+u[d])/2/a:0,y=0,p=r===1?0:64,g=i*f+(t+p+y)%f,nt=i*f+(f-1-t-p+y)%f,w=(o[g]+o[nt])/128,b=1-(e-i)/e*l,tt=n.sincos.base+n.sincos.increment*w+n.sincos.increment*v+c*w*b+s*v*b+0;n.sincos.radius=tt;n.x=n.sincos.x*n.sincos.radius;n.y=n.sincos.y*n.sincos.radius;n.z=10*r+i*.01});n.verticesNeedUpdate=!0}function ui(){it.opacity=i.pow;angular.forEach(kt,function(n,t){ct(n.geometry,rt[t],t,1);n.material.opacity=(0+1*t/e)*i.pow;n.material.color=s.values.lines;p&&ft[t].setGeometry(ot[t])});angular.forEach(dt,function(n,t){ct(n.geometry,ut[t],t,2);n.material.opacity=(0+1*t/e)*i.pow;n.material.color=s.values.overLines;p&&et[t].setGeometry(st[t])});w.rotation.z+=.001;b.rotation.z-=.001;v>1023?u.position.copy(g.circle.position):u.position.copy(lt);u.rotation.x+=(c.y*.00625-u.rotation.x)/12;u.rotation.y+=(c.x*.0125-u.rotation.y)/12;var t=l.ribbon.cameraSpline.getPointAt((n+.1)/s.steps.length);t.y+=s.values.targetHeight;r.position.copy(t);r.scale.x=r.scale.y=r.scale.z=.001+.14*i.pow;r.lookAt(o.position)}var at=t(h.circle.points,h.circle.lines),vt=t(h.circle.points,h.circle.lines),d,r,e=h.circle.lines,f=h.circle.points,g=s.getStepAtIndex(n),y=(new THREE.TextureLoader).load(g.circle.texture),k,w,b,ti,lt;y.wrapS=THREE.RepeatWrapping;y.wrapT=THREE.RepeatWrapping;y.repeat.set(1,1);var tt=new THREE.Vector2(window.innerWidth,window.innerHeight),it=new THREE.MeshBasicMaterial({color:16777215,map:y,transparent:!0}),yt=new THREE.LineBasicMaterial({color:s.values.lines,transparent:!0}),pt=new THREE.LineBasicMaterial({color:s.values.overLines,transparent:!0}),wt=new MeshLineMaterial({color:s.values.lines,lineWidth:1,depthTest:!1,opacity:1,transparent:!0,resolution:tt,near:o.near,far:o.far}),bt=new MeshLineMaterial({color:s.values.overLines,lineWidth:1,depthTest:!1,opacity:1,transparent:!0,resolution:tt,near:o.near,far:o.far});r=new THREE.Object3D;var rt=[],ut=[],ft=[],et=[],ot=[],st=[],p=!1,u=new THREE.Object3D;r.add(u);d=new THREE.PlaneGeometry(h.circle.radius*2-20,h.circle.radius*2-20,8,8);k=new THREE.Mesh(d,it);k.position.z=-30;u.add(k);w=new THREE.Object3D;u.add(w);b=new THREE.Object3D;u.add(b);var kt=new Array(e).fill(null).map(ii),dt=new Array(e).fill(null).map(ri),i={pow:0,enabled:!1,adding:!1,removing:!1};return ti=0,lt=new THREE.Vector3(0,100,0),{add:gt,remove:ni,object:r,state:i,update:ui}}function lt(){et();nt.update();ut&&ut.update();l.ribbon&&l.ribbon.update();angular.forEach(l.circles,function(n){n&&n.state.enabled&&n.update()});p.render(a,o)}function ft(){b.begin();lt();b.end();requestAnimationFrame(ft)}function at(){function n(){v=window.innerWidth;y=window.innerHeight;it=v/2;rt=y/2;p.setSize(v,y);o.aspect=v/y;o.updateProjectionMatrix()}function t(n){var t=window.innerWidth/2,i=window.innerHeight/2;w.x=(n.clientX-t)/t;w.y=(n.clientY-i)/i}window.addEventListener("resize",n,!1);document.addEventListener("mousemove",t,!1)}var g=f.data,w,c;if(g){var l=g.objects,h=i,s=r,nt=u,b,a,o,k,d,tt,p,v,y,it,rt,ut=null;f.$on("onStepChanged",function(n,t){var r=null,i=t.current,u=t.previous;i>0&&(r=l.circles[i]||ct(i),r.add());l.circles[i]=r;setTimeout(function(){if(s.current!==u&&u>0){var n=l.circles[u];n&&n.remove()}},s.duration*1e3)});f.$on("onOptionsChanged",function(){});w={x:0,y:0};c={x:0,y:0,i:0};ot();st();at();ft()}}}}]);Number.prototype.mod=function(n){return(this%n+n)%n}}(),function(){"use strict";function i(){var n=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(n=!0)}(navigator.userAgent||navigator.vendor||window.opera),n}function r(){var n=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(n=!0)}(navigator.userAgent||navigator.vendor||window.opera),n}var t=angular.module("app"),u=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,f=i(),n=r();t.constant("SceneOptions",{colors:{background:15395048,lines:11845597,overLines:3363748},camera:{cameraHeight:0,targetHeight:5},ribbon:{steps:12,points:24,vertices:n?1200:2400},circle:{position:new THREE.Vector3,radius:200,lines:24,points:n?64:128},audio:{volume:.9,bands:n?64:128},audioStrength:100,noiseStrength:25,circularStrength:.9,useBackground:!1,device:{mobile:n,ios:u}})}();
>>>>>>> ecc054c33976a4884e7136dfc386340d60b8cd23
