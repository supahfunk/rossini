(function(){"use strict";var n=angular.module("app",["ngSilent","ngRoute","ngSanitize","jsonFormatter"])})(),function(){"use strict";var n=angular.module("app");n.config(["$httpProvider",function(){}])}(),function(){"use strict";var n=angular.module("app");n.config(["$locationProvider","$routeProvider",function(n,t){n.html5Mode(!1);n.hashPrefix("");t.when("/test",{templateUrl:function(){return"partials/test.html"},controller:"TestCtrl"}).when("/years",{templateUrl:function(){return"partials/years.html"},controller:"YearsCtrl"}).when("/years/:yearsKey",{templateUrl:function(){return"partials/years.html"},controller:"YearsCtrl"}).when("/years/:yearsKey/detail",{templateUrl:function(){return"partials/years.html"},controller:"YearsCtrl"});t.otherwise("/years")}])}(),function(){"use strict";var n=angular.module("app");n.run(["$rootScope",function(){}])}(),function(){"use strict";var n=angular.module("app");n.factory("DatGui",["$rootScope","SceneOptions","StepperService",function(n,t,i){function u(){function e(){var t=h.getCurrentStep();t.colors.background=u.colors.background;t.colors.lines=u.colors.lines;t.colors.overLines=u.colors.overLines;t.camera.cameraHeight=u.camera.cameraHeight;t.camera.targetHeight=u.camera.targetHeight;t.circle&&t.circle.position.copy(u.circle.position);n.$broadcast("onOptionsChanged")}function c(n){var t=n.key.toLowerCase();t==="a"&&n.ctrlKey&&$(document).find("body").toggleClass("gui-active")}var u=t,h=i,f=new dat.GUI,o,s;u.randomize=function(){function n(n){for(var t,r,i=0;i<n.length;i++)t=n[i],t.__min&&(r=t.__min+(t.__max-t.__min)*Math.random(),t.setValue(r),t.updateDisplay()),t.__color&&(t.__color.r=Math.floor(Math.random()*255),t.__color.g=Math.floor(Math.random()*255),t.__color.b=Math.floor(Math.random()*255),t.updateDisplay(),t.setValue(t.__color.hex))}n(f.__controllers);angular.forEach(f.__folders,function(t){n(t.__controllers)})};u.saveJson=function(){var n=h.steps.map(function(n){n=angular.copy(n);var t={background:"#"+new THREE.Color(n.colors.background).getHexString(),lines:"#"+new THREE.Color(n.colors.lines).getHexString(),overLines:"#"+new THREE.Color(n.colors.overLines).getHexString()};return n.colors=t,n});console.log("saveJson",n);r(n,"rossini.js",!0,!0)};f.closed=!0;f.add(u.camera,"cameraHeight",-10,30).listen().onChange(e);f.add(u.camera,"targetHeight",-10,30).listen().onChange(e);o=f.addFolder("circlePosition");o.add(u.circle.position,"x",-300,300).listen().onChange(e);o.add(u.circle.position,"y",-300,300).listen().onChange(e);o.add(u.circle.position,"z",-300,300).listen().onChange(e);s=f.addFolder("colors");s.addColor(u.colors,"background").listen().onChange(e);s.addColor(u.colors,"lines").listen().onChange(e);s.addColor(u.colors,"overLines").listen().onChange(e);f.add(u.audio,"volume",.01,1).onChange(e);f.add(u,"audioStrength",10,100).onChange(e);f.add(u,"noiseStrength",10,100).onChange(e);f.add(u,"circularStrength",.01,.9).onChange(e);f.add(u,"randomize");f.add(u,"saveJson");angular.element(window).on("keydown",c);return f}var r=function(){var n=document.createElement("a");return document.body.appendChild(n),n.style="display: none",function(t,i,r,u){r&&(t=u?JSON.stringify(t,null,2):JSON.stringify(t));var e=new Blob([t],{type:"octet/stream"}),f=window.URL.createObjectURL(e);n.href=f;n.download=i;n.click();window.URL.revokeObjectURL(f)}}();return u}])}(),function(){"use strict";var n=angular.module("app");n.directive("navTo",["$parse","$timeout",function(n,t){return{restrict:"A",link:function(i,r,u){function o(){console.log("navTo.onTap",u.navTo);t(function(){var t=n(u.navTo);t(i)})}function f(){o();r.off("mousedown",e)}function e(){o();r.off("touchstart",f)}function s(){r.on("touchstart",f).on("mousedown",e)}function h(){r.off("touchstart",f).off("mousedown",e)}s();i.$on("$destroy",function(){h()})}}}])}(),function(){"use strict";var n=angular.module("app");n.directive("scrollbar",[function(){return{restrict:"A",link:function(n,t){function u(){var t=Scrollbar.init(i,r);n.$watch(t.contentEl.offsetHeight,function(){t.update()})}var i=t[0],r={speed:1,damping:.1,overscrollDamping:1,thumbMinSize:20,continuousScrolling:!0,alwaysShowTracks:!1};setTimeout(u,100)}}}])}(),function(){"use strict";var n=angular.module("app");n.directive("slickTunnel",["$timeout","StepperService","SceneOptions",function(n,t,i){return{restrict:"A",link:function(n,r,u){function e(){r.hasClass("slick-initialized")&&r.slick("unslick")}function v(){e();r.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,draggable:!1,asNavFor:a.useBackground?".tunnel-bg":null,cssEase:"cubic-bezier(0.7, 0, 0.3, 1)",initialSlide:f.current})}function o(){var n=$(".slick-active .splitted-letter");TweenMax.staggerTo(n,1,{delay:.2,y:0,x:0,ease:Power3.easeInOut,className:"+=viewed",onComplete:function(){$(".slick-active .cta").addClass("active")}},.009)}function y(){var n=$(".slick-active .splitted-letter");TweenMax.staggerTo(n,1,{delay:0,y:100,x:50,ease:Power3.easeInOut,className:"-=viewed"},.009);$(".slick-active .cta").removeClass("active")}function s(){setTimeout(function(){o()},500);n.$root.$broadcast("onSlickInit")}function h(t,i,r,u){f.slicking=!0;y();n.$root.$broadcast("onSlickBeforeChange",{current:u,previous:r})}function c(t,i,r){f.slicking=!1;o();n.$root.$broadcast("onSlickAfterChange",{current:r})}function l(n){if(!f.slicking){if(r.hasClass("slick-initialized"))if(n.deltaX>0||n.deltaY<0)r.slick("slickNext");else if(n.deltaX<0||n.deltaY>0){if(f.current==1)return;r.slick("slickPrev")}n.preventDefault()}}function p(){r.on("init",s).on("beforeChange",h).on("afterChange",c).on("mousewheel",l)}function w(){r.off("init",s).off("beforeChange",h).off("afterChange",c).off("mousewheel",l)}var a=i,f=t;p();n.$watchCollection(u.slickTunnel,function(n){n&&n.length&&v()});n.$on("onGoStep",function(n,t){r.hasClass("slick-initialized")&&r.slick("slickGoTo",t)});n.$on("$destroy",function(){w();e()})}}}]);n.directive("slickBackgrounds",[function(){return{restrict:"A",link:function(n,t,i){function r(){t.hasClass("slick-initialized")&&t.slick("unslick")}function u(){r();t.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,lazyLoad:"ondemand",cssEase:"cubic-bezier(0.7, 0, 0.3, 1)"})}n.$watchCollection(i.slickBackgrounds,function(n){n&&n.length&&setTimeout(u,1)});n.$on("$destroy",function(){r()})}}}])}(),function(){"use strict";var n=angular.module("app");n.directive("splitText",[function(){return{restrict:"A",link:function(n,t){function i(){var e=t[0].childNodes,n,i,o,r,u,v,s,f,h;for(e=Array.prototype.slice.call(e,0),t.html("").addClass("active"),n=[[]],e.filter(function(n){return n.nodeType===3||n.nodeType===1}).map(function(t){if(t.nodeType===3)t={text:$.trim(t.textContent),element:"span"};else{if(t.nodeName.toLowerCase()==="br"){n.push([]);return}t={text:$.trim(t.innerHTML),element:t.nodeName}}t.text!==""&&n[n.length-1].push(t)}),i=0;i<n.length;i++)for(o=n[i],$('<div class="splitted-row"><\/div>').appendTo(t),r=0;r<o.length;r++){var c=o[r],l=c.element.toLowerCase(),y=c.text,a=y.split(" ");for(u=0;u<a.length;u++){for($("<"+l+' class="splitted-word"><\/'+l+">").appendTo($(".splitted-row:last"),t),v=a[u],s=v.split(""),f=0;f<s.length;f++)h=s[f],$('<span class="splitted-letter" data-content="'+h+'">'+h+"<\/span>").appendTo($(".splitted-word:last"),t);$('<span class="splitted-space">&nbsp;<\/span>').appendTo($(".splitted-word:last"),t)}}}setTimeout(function(){i()},1)}}}])}(),function(){"use strict";var n=angular.module("app");n.directive("yearsFrom",[function(){return{restrict:"A",scope:{from:"=yearsFrom",to:"=yearsTo"},link:function(n,t){function i(){function f(){e.html(parseInt(i.from));o.html(parseInt(i.to))}var e=t.find(".from"),o=t.find(".to"),r=2,u=Power3.easeOut,i={from:e.html(),to:o.html()};n.to?(t.removeClass("one-year"),TweenLite.to(i,r,{to:n.to,roundProps:"year",onUpdate:f,ease:u})):(t.addClass("one-year"),TweenLite.to(i,r,{to:n.from,roundProps:"year",onUpdate:f,ease:u}));TweenLite.to(i,r,{from:n.from,roundProps:"year",onUpdate:f,ease:u})}n.$watch("from",function(n){n&&i()})}}}])}(),function(){"use strict";var n=angular.module("app");n.controller("TestCtrl",["$scope","$route","$routeParams","$ngSilentLocation","MotionService","$timeout",function(n,t,i,r,u,f){function s(){f(function(){e.update()})}function o(){s();requestAnimationFrame(o)}var e=u;e.init();o();n.motion=e}])}(),function(){"use strict";var n=angular.module("app");n.controller("YearsCtrl",["$scope","$timeout","$route","$routeParams","$ngSilentLocation","$q","State","SceneOptions","StepperService","AudioService","AssetService","DatGui",function(n,t,i,r,u,f,e,o,s,h,c,l){function k(){function i(i){t(function(){n.progress=i})}f.all([d(i),g(i),]).then(function(){w()},function(n){console.log("YearsCtrl.error",n);y.error(n)})}function d(n){var t=[];return a.steps.filter(function(n){n.audio&&t.indexOf(n.audio.url)==-1&&t.push(n.audio.url)}),h.preload(t,n)}function g(n){var t=[];return a.steps.filter(function(n){n.circle&&n.circle.texture&&t.indexOf(n.circle.texture)==-1&&t.push(n.circle.texture)}),c.preload(t,n)}function w(){t(function(){a.navStep(a.current);i.current.$$route.originalPath.indexOf("/detail")!==-1&&t(function(){b()})},1e3);var n=new l;y.ready()}function b(){return u.silent(a.step.detailUrl),a.detail.active=!0,a.detail.operas=[{title:"La cambiale di matrimonio",url:"audio/04-rossini-192.mp3",orchestra:"Academy of St Martin in the Fields Orchestra"},{title:"L’occasione fa il ladro, ossia Il cambio della valigia",url:"audio/04-rossini-192.mp3",orchestra:"Academy of St Martin in the Fields Orchestra"},{title:"Otello"},{title:"Mosè in Egitto"},{title:"Ivanhoé"}],!1}function nt(){return u.silent(a.step.url),a.detail.active=!1,!1}var y=new e,v={objects:{},options:o,stepper:s,assets:c},tt=v.objects,p=v.options,a=v.stepper,it=v.assets;y.busy();a.init(r.yearsKey).then(function(){n.stepper=a;n.scene=v;n.audio=h;p.preload?k():w()});n.state=y;n.options=p;n.openDetail=b;n.closeDetail=nt;n.$on("onStepChanged",function(){u.silent(a.step.url)})}])}(),function(){"use strict";var n=angular.module("app");n.controller("RootCtrl",["$scope","$route","$location","$http","$timeout","$ngSilentLocation","StepperService",function(n,t,i,r,u,f,e){function o(t){function i(n,t){n&&angular.forEach(n,function(n){n.parent=t;n.years&&(n.years.key=String(n.years.to?n.years.from+"-"+n.years.to:n.years.from),n.url="/years/"+n.years.key);i(n.items,n)})}i(t);n.menu=t;u(function(){nav()},100)}function s(n){var i=e,r=i.steps,t=-1;angular.forEach(r,function(i,r){i.url===n.url&&(t=r)});t!==-1&&(i.navStep(t),f.silent(n.url))}function h(i,r){if(i.url){if(i.url.indexOf("/years")!==-1&&t.current.$$route.originalPath.indexOf("/years")!==-1){var f=e;f.detail.active=!1;closeNav();u(function(){s(i)},1e3)}n.submenu=null;console.log("RootCtrl.navTo",i.url)}else r===2&&i.items&&(n.submenu?u(function(){n.submenu=i},1e3):n.submenu=i)}r.get("json/menu-rossini.js").then(function(n){o(n.data)},function(n){console.log("RootCtrl.error",n)});n.navTo=h}])}(),function(){var n=angular.module("app");n.factory("State",["$timeout",function(n){function i(){this.errors=[];this.isReady=!1;this.idle()}function r(){this.isBusy=!1;this.isError=!1;this.isErroring=!1;this.isSuccess=!1;this.isSuccessing=!1;this.button=null}function u(){return!this.isBusy&&!this.isErroring&&!this.isSuccessing}function f(){return this.isBusy?!1:(this.isBusy=!0,this.isError=!1,this.isErroring=!1,this.isSuccess=!1,this.isSuccessing=!1,this.errors=[],!0)}function e(){this.isBusy=!1;this.isError=!1;this.isErroring=!1;this.isSuccess=!0;this.isSuccessing=!0;this.errors=[];n(function(){this.isSuccessing=!1}.bind(this),t)}function o(i){this.isBusy=!1;this.isError=!0;this.isErroring=!0;this.isSuccess=!1;this.isSuccessing=!1;this.errors.push(i);n(function(){this.isErroring=!1}.bind(this),t)}function s(){this.idle();this.isReady=!0}function h(){return this.errors.length>0?this.errors[this.errors.length-1]:null}function c(){return{busy:this.isBusy,ready:this.isReady,successing:this.isSuccessing,success:this.isSuccess,errorring:this.isErroring,error:this.isError}}function l(n,t){var u=this,i={ready:"submit",busy:"sending",error:"error",erroring:"erroring",success:"success",successing:"successing"},r;return n&&angular.extend(i,n),r=i.ready,this.isBusy?r=i.busy:this.isSuccessing?r=i.successing:this.isErroring&&(r=i.erroring),t&&(this.isSuccess?r=i.success:this.isError&&(r=i.error)),r}function a(n){var t=this,i=null;return i={ready:t.isReady,busy:t.isBusy,successing:t.isSuccessing,success:t.isSuccess,errorring:t.isErroring,error:t.isError,pulse:t.isBusy,flash:t.isErroring||t.isSuccessing},n&&angular.forEach(n,function(n,t){i[n]=i[t]}),i}var t=2e3;return i.prototype={idle:r,busy:f,enabled:u,error:o,ready:s,success:e,errorMessage:h,submitClass:c,labels:l,classes:a},i}])}(),function(){"use strict";var n=angular.module("app");n.service("AssetService",["$q",function(n){function r(t,r){function o(n){e[n.path]=n;angular.forEach(e,function(t){n.loaded+=t.loaded;n.total+=t.total});n.progress=n.loaded/n.total;r(n)}var f=n.defer(),e={},u={loaded:0,total:0};return n.all(t.map(function(n){return i(n,o)})).then(function(){u.loaded=u.total;u.progress=1;r(u);f.resolve()},function(n){console.log("AssetService.preload.error",n);f.reject(n)}),f.promise}function i(i,r){var e=n.defer(),f={path:i,loaded:0,total:1},u=new XMLHttpRequest;return u.responseType="arraybuffer",u.open("GET",i,!0),u.onload=function(){var r=new Blob([u.response]),n=new Image;n.src=window.URL.createObjectURL(r);t[i]=n;e.resolve(n)},u.onerror=function(n){console.log("AssetService.xhr.onerror",n);e.reject(n)},r&&(u.onprogress=function(n){f.loaded=n.loaded;f.total=n.total;f.progress=n.loaded/n.total;r(f)}),u.send(),e.promise}var u=this,t={};this.load=i;this.preload=r;this.images=t}])}(),function(){"use strict";var n=angular.module("app");n.factory("AudioSound",["$q","SceneOptions",function(n,t){function r(n){var t={volume:.85,loop:!1},i;n&&angular.extend(t,n);i=this;i.options=t;i.offset=t.offset||0;this.addAnalyserNode();this.addGainNode()}function f(t,r){var e=n.defer(),o={path:t,loaded:0,total:1},f=new XMLHttpRequest;return f.responseType="arraybuffer",f.open("GET",t,!0),f.onload=function(){i.decodeAudioData(f.response,function(n){if(!n){console.log("AudioSound.load.decodeAudioData.error",t);e.reject("AudioSound.load.decodeAudioData.error");return}u[t]=n;e.resolve(n)})},f.onerror=function(n){console.log("AudioManager.xhr.onerror",n);e.reject(n)},r&&(f.onprogress=function(n){o.loaded=n.loaded;o.total=n.total;o.progress=n.loaded/n.total;r(o)}),f.send(),e.promise}window.AudioContext=window.AudioContext||window.webkitAudioContext;var i=new AudioContext,u={};return r.prototype={nodes:{},addGainNode:function(){var n=this,t=i.createGain?i.createGain():i.createGainNode();t.gain.value=n.options.volume;n.nodes.gain=t},addAnalyserNode:function(){var r=this,n;r.options.analyser&&(n=i.createAnalyser(),n.fftSize=t.audio.bands*2,r.data=new Uint8Array(n.frequencyBinCount),r.nodes.analyser=n)},connectNodes:function(){var n=this,u=n.source,t,r;for(t in n.nodes)r=n.nodes[t],u.connect(r),t==="gain"&&r.connect(i.destination)},disconnect:function(){var n=this,r=n.source,t,u;if(r){for(t in n.nodes)u=n.nodes[t],t==="gain"&&u.disconnect(i.destination),r.disconnect(n.nodes[t]);n.source=null}},updateBuffer:function(){var u=n.defer(),r=this,t=r.source;return r.getBuffer().then(function(n){t?t.buffer=n:(t=i.createBufferSource(),t.buffer=n,r.source=t,r.connectNodes());u.resolve(t)},function(n){u.reject(n)}),u.promise},getBuffer:function(){var t=n.defer(),f=this,i=f.path,e=u[i];return e?t.resolve(e):r.load(i).then(function(n){f.path===i&&t.resolve(n)},function(n){t.reject(n)}),t.promise},getSource:function(){var r=n.defer(),t=this,u=t.source;return u?r.resolve(u):t.getBuffer().then(function(n){var u=null;t.playing&&(u=t.source,u&&(typeof u.stop=="function"?u.stop(0):u.noteOff(0),t.disconnect()));u=i.createBufferSource();u.buffer=n;t.source=u;t.connectNodes();r.resolve(u)},function(n){r.reject(n)}),r.promise},play:function(){var n=this,t;n.playing||(t=n.options,n.getSource().then(function(r){n.startTime=i.currentTime;r.loop=t.loop;typeof r.start=="function"?r.start(0,n.offset):r.noteOn(0,n.offset);n.playing=!0}))},stop:function(){var n=this,t;n.playing&&(t=n.source,t&&(n.offset+=n.startTime?i.currentTime-n.startTime:0,typeof t.stop=="function"?t.stop(0):t.noteOff(0),n.disconnect(),n.playing=!1))},update:function(){var n=this;n.nodes.analyser&&n.nodes.analyser.getByteFrequencyData(n.data)},setPath:function(n){var t=this;n&&t.path!==n&&(t.stop(),t.path=n,t.offset=t.options.offset||0,console.log("AudioSound.setPath",n))},setVolume:function(n){var t=this;n!==t.options.volume&&(t.options.volume=n,t.nodes.gain.gain.value=n)}},r.load=f,r}]);n.service("AudioService",["$rootScope","$timeout","$q","$http","AudioSound","SceneOptions","StepperService",function(n,t,i,r,u,f,e){function y(){return o.data}function p(){var n=v.getCurrentStep();l(n.audio?n.audio.url:null)}function l(n){o.setPath(n);h()}function w(n){n.url&&(s.active=!0,l(n.url))}function b(n){o.setVolume(n)}function k(){s.active&&o.playing&&(o.setVolume(c.audio.volume),o.update())}function h(){s.active&&o.path&&!o.playing&&o.play()}function a(){o.playing&&o.stop()}function d(){s.active=!s.active;s.active?h():a()}function g(){return s.active&&o.playing}function nt(){return o.playing}function tt(n,t){function o(n){e[n.path]=n;angular.forEach(e,function(t){n.loaded+=t.loaded;n.total+=t.total});n.progress=n.loaded/n.total;t(n)}var f=i.defer(),e={},r={loaded:0,total:0};return i.all(n.map(function(n){return u.load(n,o)})).then(function(){r.loaded=r.total;r.progress=1;t(r);f.resolve()},function(n){console.log("AudioSound.preload.error",n);f.reject(n)}),f.promise}var s=this,c=f,v=e,o=new u({analyser:!0,loop:!0});n.$on("onStepChanged",function(){p()});n.$on("onOptionsChanged",function(){o.setVolume(c.audio.volume)});this.active=!0;this.getData=y;this.setVolume=b;this.setAudio=w;this.update=k;this.play=h;this.pause=a;this.toggle=d;this.isPlaying=nt;this.isActive=g;this.preload=tt}])}(),function(){"use strict";var t=angular.module("app"),n=Date.now||function(){return(new Date).getTime()};t.service("MotionService",["$rootScope",function(n){function i(i,r,u){t.x=i;t.y=r;t.z=u;n.$broadcast("onDeviceMotion",t)}function r(){window.DeviceOrientationEvent&&window.addEventListener("deviceorientation",u,!0)}function u(n){var t=n.beta,r=n.gamma,u=0;t=Math.min(t,30);t=Math.max(t,-30);r/=20;t/=20;u/=20;i(r,t,u)}function f(){r()}var t=this;t.x=0;t.y=0;t.z=0;t.init=f}])}(),function(){"use strict";var n=angular.module("app");n.service("StepperService",["$rootScope","$timeout","$q","$http","$sce","SceneOptions",function(n,t,i,r,u,f){function p(n){var f=i.defer(),t=0;return s.length?(angular.forEach(s,function(i,r){i.years.key===n&&(t=r)}),a.pow=t/s.length,e.current=o=t,f.resolve(s)):r.get("json/rossini.js").then(function(i){var r=i.data;angular.forEach(r,function(i,r){i.years.key=String(i.years.to?i.years.from+"-"+i.years.to:i.years.from);i.url="/years/"+i.years.key;i.detailUrl=i.url+"/detail";i.years.key===n&&(t=r);i.titleTrusted=u.trustAsHtml(i.title);i.contrast=it(i.colors.background);i.circle&&(i.circle.position=(new THREE.Vector3).copy(i.circle.position));s.push(i)});a.pow=t/s.length;e.current=o=t;f.resolve(s)},function(n){f.reject(n)}),f.promise}function v(){while(c.length){var n=c.pop();n.kill()}}function w(n,t,i,r){v();var o=new THREE.Color(t.colors.background),u=new THREE.Color(t.colors.lines),f=new THREE.Color(t.colors.overLines);c.push(TweenLite.to(e.values,i,{pow:n,cameraHeight:t.camera.cameraHeight,targetHeight:t.camera.targetHeight,delay:0,ease:Power2.easeInOut,onComplete:function(){r&&r()}}));c.push(TweenLite.to(e.values.lines,i,{r:u.r,g:u.g,b:u.b,delay:0,ease:Power2.easeInOut}));c.push(TweenLite.to(e.values.overLines,i,{r:f.r,g:f.g,b:f.b,delay:0,ease:Power2.easeInOut}))}function b(n){var t=e.current,i=s[t];w(t/s.length,i,n,function(){v()})}function k(i){t(function(){var r=e.current||0,t;e.current=o=i;t=s[i];e.step=t;h.colors.background=t.colors.background;h.colors.lines=t.colors.lines;h.colors.overLines=t.colors.overLines;h.camera.cameraHeight=t.camera.cameraHeight;h.camera.targetHeight=t.camera.targetHeight;t.circle&&h.circle.position.copy(t.circle.position);y(i);n.$broadcast("onStepChanged",{current:i,previous:r});b(e.duration)})}function d(){return s[o]}function g(n){return s[n]}function nt(){e.slicking||(o--,o=Math.max(0,o),l(o),n.$broadcast("onGoStep",o))}function tt(){e.slicking||(o++,o=Math.min(s.length-1,o),l(o),n.$broadcast("onGoStep",o))}function l(i){k(i);n.$broadcast("onGoStep",i);t(function(){var t=$(".tunnel-nav__step.active"),n,i;t.length&&(n=t.position().top,i=t.width()+16,$(".tunnel-nav__follower").css({width:i+"px","-webkit-transform":"translateY("+n+"px)","-moz-transform":"translateY("+n+"px)","-ms-transform":"translateY("+n+"px)",transform:"translateY("+n+"px)"}))})}function y(n){if(!h.useBackground){var t=e.getStepAtIndex(n),i=new THREE.Color(t.colors.background).getHexString();$(".tunnel-gradient").css("background-color","#"+i)}}function it(n){var t=new THREE.Color(n),i=parseInt(t.r*255),r=parseInt(t.g*255),u=parseInt(t.b*255),f=i*.299+r*.587+u*.114;return f>125?"light-bg":"dark-bg"}var e=this,h=f,o=0,s=[],c=[],a={pow:0,background:new THREE.Color(h.colors.background),lines:new THREE.Color(h.colors.lines),overLines:new THREE.Color(h.colors.overLines),cameraHeight:h.camera.cameraHeight,targetHeight:h.camera.targetHeight};n.$on("onOptionsChanged",function(){var t=e.current,n=s[t];e.values.cameraHeight=n.camera.cameraHeight;e.values.targetHeight=n.camera.targetHeight;e.values.background.copy(new THREE.Color(n.colors.background));e.values.lines.copy(new THREE.Color(n.colors.lines));e.values.overLines.copy(new THREE.Color(n.colors.overLines));y(t)});n.$on("onSlickBeforeChange",function(n,t){l(t.current)});this.init=p;this.values=a;this.duration=2.5;this.steps=s;this.navStep=l;this.getCurrentStep=d;this.getStepAtIndex=g;this.current=o;this.detail={};this.previous=nt;this.next=tt}])}(),function(){"use strict";function t(n,t){for(var i,s,h,f=n*t,e=new Uint8Array(f),c=new r,u=1,l=Math.random()*100,o=0;o<4;o++){for(i=0;i<f;i++)s=i%n,h=~~(i/n),e[i]+=Math.abs(c.noise(s/u,h/u,l)*u*1.75);u*=5}return e}function r(){function u(n){return n*n*n*(n*(n*6-15)+10)}function i(n,t,i){return t+n*(i-t)}function t(n,t,i,r){var u=n&15,f=u<8?t:i,e=u<4?i:u==12||u==14?t:r;return((u&1)==0?f:-f)+((u&2)==0?e:-e)}for(var n=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],r=0;r<256;r++)n[256+r]=n[r];return{noise:function(r,f,e){var a=Math.floor(r),v=Math.floor(f),y=Math.floor(e),p=a&255,w=v&255,o=y&255;r-=a;f-=v;e-=y;var s=r-1,h=f-1,l=e-1,c=u(r),b=u(f),rt=u(e),k=n[p]+w,d=n[k]+o,g=n[k+1]+o,nt=n[p+1]+w,tt=n[nt]+o,it=n[nt+1]+o;return i(rt,i(b,i(c,t(n[d],r,f,e),t(n[tt],s,f,e)),i(c,t(n[g],r,h,e),t(n[it],s,h,e))),i(b,i(c,t(n[d+1],r,f,l),t(n[tt+1],s,f,e-1)),i(c,t(n[g+1],r,h,l),t(n[it+1],s,h,l))))}}}function n(n,t,i){var r=-1+Math.random()*2,u=Math.abs(r),f=i?Math.floor(r/u):1;return f*(n+(t-n)*u)}var i=angular.module("app");i.directive("scene",["SceneOptions","StepperService","AudioService","AssetService","MotionService",function(i,r,u,f,e){return{restrict:"A",scope:{data:"=scene"},link:function(o,s){function at(){var i,r,n,t;h.device.mobile?(a.x=rt.x*20,a.y=rt.y*20):(a.x=it.x*20,a.y=it.y*20);i=a.x/4;r=a.y/4;b.x+=(i-b.x)*d;b.y+=(r-b.y)*d;$(".detail-active").length===0&&(n="translate("+b.x*-4+"px, "+b.y*-2+"px)",$(".tunnel-year__wrap").css({"-webit-transform":n,"-moz-transform":n,transform:n}));t="translate("+b.x+"px, "+b.y+"px)";$(".tunnel-slick .slick-active .tunnel-slick__item").css({"-webit-transform":t,"-moz-transform":t,transform:t});a.x+=Math.cos(a.i/100)*10;a.y+=Math.sin(a.i/100)*10;a.i++}function vt(){p=window.innerWidth;w=window.innerHeight;ot=p/2;st=w/2;var n=p/w;y=new THREE.Scene;c=new THREE.PerspectiveCamera(30,n,1,2e4);k=new THREE.WebGLRenderer({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0});k.setClearColor(0,0);k.setSize(p,w);k.sortObjects=!1;g=new Stats;s[0].appendChild(k.domElement);s[0].appendChild(g.dom)}function yt(){v.ribbon=pt();v.circles=new Array(l.steps).fill(null)}function pt(){function s(){y.add(f)}function w(){y.remove(f)}function b(){var u=1/l.steps.length,f=u*.1,r=l.values.pow,e=(r+f).mod(1),o=l.getCurrentStep(),n=t.getPointAt(r),i;n.y+=l.values.cameraHeight;i=t.getPointAt(e);i.y+=l.values.targetHeight;c.position.copy(n);c.target.copy(i);c.position.x+=(n.x+a.x-c.position.x)*d;c.position.y+=(n.y+a.y-c.position.y)*d;c.lookAt(c.target)}var v=new THREE.Vector2(window.innerWidth,window.innerHeight),o=new MeshLineMaterial({color:l.values.lines,lineWidth:5,opacity:.8,transparent:!0,depthTest:!1,sizeAttenuation:!0,resolution:v,near:c.near,far:c.far}),r=new THREE.Vector3,p=new Array(h.ribbon.points).fill(null).map(function(){var t=(new THREE.Vector3).copy(r);return r.x+=n(500,1e3,!0),r.y+=n(10,40,!0),r.z+=n(1e3,2e3,!1),t}),i=new THREE.CatmullRomCurve3(p),t,u,e,f;return i.type="catmullrom",i.closed=!1,t=new THREE.CatmullRomCurve3(i.points.map(function(n){return new THREE.Vector3(n.x,n.y+20,n.z)})),t.type="catmullrom",t.closed=!1,u=new THREE.Geometry,u.vertices=i.getPoints(h.ribbon.vertices),e=new MeshLine,e.setGeometry(u),f=new THREE.Mesh(e.geometry,o),s(),c.target=c.target||new THREE.Vector3(0,0,0),{object:f,spline:i,cameraSpline:t,geometry:u,material:o,add:s,remove:w,update:b}}function wt(n,t){var f,u,i;t=t||512;f=t/2;u=document.createElement("canvas");u.width=t;u.height=t;i=u.getContext("2d");i.beginPath();i.arc(f,f,f-1,0,Math.PI*2);i.clip();var e=new THREE.MeshBasicMaterial({color:16777215,map:new THREE.Texture(u),transparent:!0}),s=l.getStepAtIndex(n),o=s.circle.texture,r=null;return h.preload?(r=lt.images[o],i.drawImage(r,0,0,t,t),e.map.needsUpdate=!0):(r=new Image,r.onload=function(){i.drawImage(r,0,0,t,t);e.map.needsUpdate=!0},r.src=o),e}function bt(n){var t,i,u,r,f;return n=n||512,t=n/2,i=document.createElement("canvas"),i.width=n,i.height=n,u=i.getContext("2d"),r=u.createRadialGradient(t,t,30,t,t,t),r.addColorStop(0,"rgba(0,0,0,0.35)"),r.addColorStop(.1,"rgba(0,0,0,0.33)"),r.addColorStop(1,"rgba(0,0,0,0.0)"),u.fillStyle=r,u.fillRect(0,0,n,n),f=new THREE.MeshBasicMaterial({color:16777215,map:new THREE.Texture(i),transparent:!0}),f.map.needsUpdate=!0,f}function kt(n){function ii(){y.add(u);i.adding=Date.now();i.removing=!1;i.enabled=!0;i.tween&&i.tween.kill();i.tween=TweenLite.to(i,.35,{pow:1,delay:0,ease:Power2.easeOut,onComplete:function(){i.adding=!1}})}function ri(){i.adding=!1;i.removing=Date.now();i.tween&&i.tween.kill();i.tween=TweenLite.to(i,.35,{pow:0,delay:0,ease:Power2.easeOut,onComplete:function(){i.removing=!1;i.enabled=!1;y.remove(u)}})}function fi(n,t){var r=new THREE.Geometry,f=ct(r,t,1),i,u;return it.push(f),i=null,w?(u=new MeshLine,u.setGeometry(r),ot.push(r),ut.push(u),i=new THREE.Mesh(u.geometry,dt)):i=new THREE.LineLoop(r,bt.clone()),b.add(i),i}function ei(n,t){var r=new THREE.Geometry,f=ct(r,t,2),i,u;return rt.push(f),i=null,w?(u=new MeshLine,u.setGeometry(r),st.push(r),et.push(u),i=new THREE.Mesh(u.geometry,gt)):i=new THREE.LineLoop(r,kt.clone()),k.add(i),i}function ct(t,i,r){var u=new Array(f).fill(null).map(function(u,e){var a=e/f,o=360*a;o+=60*n;o+=30*r;o+=360/f*.1*i;var s=o*Math.PI/180,c=h.circle.radius,l=0;return l+=r===1?i*i*i*.005:i*i*i*.005,u=new THREE.Vector3,u.sincos={base:c,increment:l,radius:c,x:Math.cos(s),y:Math.sin(s)},t.vertices.push(u),u});return t.vertices.push(u[0]),u}function lt(n,t,i,r){var l=h.audioStrength,a=h.noiseStrength,v=h.circularStrength,s=r===1?vt:yt,u=ft.getData(),c=0;angular.forEach(t,function(n,t){var o=h.audio.bands,d=t%o,g=(f-1-t)%o,y=u?(u[d]+u[g])/2/o:0;c+=y;var p=0,w=r===1?0:64,nt=i*f+(t+w+p)%f,tt=i*f+(f-1-t-w+p)%f,b=(s[nt]+s[tt])/128,k=1-(e-i)/e*v,it=n.sincos.base+n.sincos.increment*b+n.sincos.increment*y+a*b*k+l*y*k+0;n.sincos.radius=it;n.x=n.sincos.x*n.sincos.radius;n.y=n.sincos.y*n.sincos.radius;n.z=10*r+i*.01});r===1&&(o.scale.x=1+c/t.length);n.verticesNeedUpdate=!0}function oi(){tt.opacity=i.pow;angular.forEach(ni,function(n,t){lt(n.geometry,it[t],t,1);n.material.opacity=(0+1*t/e)*i.pow;n.material.color=l.values.lines;w&&ut[t].setGeometry(ot[t])});angular.forEach(ti,function(n,t){lt(n.geometry,rt[t],t,2);n.material.opacity=(0+1*t/e)*i.pow;n.material.color=l.values.overLines;w&&et[t].setGeometry(st[t])});b.rotation.z+=.001;k.rotation.z-=.001;p>1023?r.position.copy(pt.circle.position):r.position.copy(at);r.rotation.x+=(a.y*.00625-r.rotation.x)*d;r.rotation.y+=(a.x*.0125-r.rotation.y)*d;var t=v.ribbon.cameraSpline.getPointAt((n+.1)/l.steps.length);t.y+=l.values.targetHeight;u.position.copy(t);u.scale.x=u.scale.y=u.scale.z=.001+.14*i.pow;u.lookAt(c.position)}var vt=t(h.circle.points,h.circle.lines),yt=t(h.circle.points,h.circle.lines),s,u,e=h.circle.lines,f=h.circle.points,pt=l.getStepAtIndex(n),nt=new THREE.Vector2(window.innerWidth,window.innerHeight),tt=wt(n),bt=new THREE.LineBasicMaterial({color:l.values.lines,transparent:!0}),kt=new THREE.LineBasicMaterial({color:l.values.overLines,transparent:!0}),dt=new MeshLineMaterial({color:l.values.lines,lineWidth:1,depthTest:!1,opacity:1,transparent:!0,resolution:nt,near:c.near,far:c.far}),gt=new MeshLineMaterial({color:l.values.overLines,lineWidth:1,depthTest:!1,opacity:1,transparent:!0,resolution:nt,near:c.near,far:c.far}),o,g,b,k,ui,at;u=new THREE.Object3D;var it=[],rt=[],ut=[],et=[],ot=[],st=[],w=!1,r=new THREE.Object3D;u.add(r);s=new THREE.PlaneGeometry(h.circle.radius*2-20,h.circle.radius*2-20,8,8);o=new THREE.Mesh(s,ht);o.position.y=-400;o.rotation.x=-Math.PI/2;o.scale.z=.5;r.add(o);s=new THREE.PlaneGeometry(h.circle.radius*2-20,h.circle.radius*2-20,8,8);g=new THREE.Mesh(s,tt);g.position.z=-30;r.add(g);b=new THREE.Object3D;r.add(b);k=new THREE.Object3D;r.add(k);var ni=new Array(e).fill(null).map(fi),ti=new Array(e).fill(null).map(ei),i={pow:0,enabled:!1,adding:!1,removing:!1};return ui=0,at=new THREE.Vector3(0,100,0),{add:ii,remove:ri,object:u,state:i,update:oi}}function dt(){at();ft.update();v.ribbon&&v.ribbon.update();angular.forEach(v.circles,function(n){n&&n.state.enabled&&n.update()})}function gt(){dt();k.render(y,c)}function ct(){g.begin();gt();g.end();requestAnimationFrame(ct)}function ni(){function n(){p=window.innerWidth;w=window.innerHeight;ot=p/2;st=w/2;k.setSize(p,w);c.aspect=p/w;c.updateProjectionMatrix()}function t(n){var t=window.innerWidth/2,i=window.innerHeight/2;it.x=(n.clientX-t)/t;it.y=(n.clientY-i)/i}window.addEventListener("resize",n,!1);document.addEventListener("mousemove",t,!1)}var ut=o.data,ht;if(ut){var v=ut.objects,h=i,l=r,ft=u,lt=f,g,y,c,nt,tt,et,k,p,w,ot,st;console.log("scene.options",h);o.$on("onStepChanged",function(n,t){var r=null,i=t.current,u=t.previous;i>0&&(r=v.circles[i]||kt(i),r.add());v.circles[i]=r;setTimeout(function(){if(l.current!==u&&u>0){var n=v.circles[u];n&&n.remove()}},l.duration*1e3)});o.$on("onOptionsChanged",function(){});var it={x:0,y:0},a={x:0,y:0,i:0},b={x:0,y:0},d=1/12,rt=e;h.device.mobile&&rt.init();ht=bt();vt();yt();ni();ct()}}}}]);Number.prototype.mod=function(n){return(this%n+n)%n}}(),function(){"use strict";function i(){var n=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(n=!0)}(navigator.userAgent||navigator.vendor||window.opera),n}function r(){var n=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(n=!0)}(navigator.userAgent||navigator.vendor||window.opera),n}var t=angular.module("app"),u=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,f=i(),n=r();t.constant("SceneOptions",{colors:{background:15395048,lines:11845597,overLines:3363748},camera:{cameraHeight:-10,targetHeight:30},ribbon:{steps:12,points:24,vertices:n?1200:2400},circle:{position:new THREE.Vector3,radius:200,lines:n?12:24,points:n?64:128},audio:{volume:.9,bands:n?64:128},audioStrength:100,noiseStrength:25,circularStrength:.9,useBackground:!1,device:{mobile:n,ios:u},preload:!0})}();