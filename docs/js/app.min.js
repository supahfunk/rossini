<<<<<<< HEAD
!function(){"use strict";angular.module("app",["ngRoute","ngSanitize","jsonFormatter"])}(),function(){"use strict";angular.module("app").config(["$httpProvider",function(e){}])}(),function(){"use strict";angular.module("app").config(["$locationProvider",function(e){e.html5Mode(!0),e.hashPrefix("")}])}(),function(){"use strict";angular.module("app").run(["$rootScope",function(e){}])}(),function(){"use strict";angular.module("app").factory("DatGui",["$rootScope","SceneOptions","StepperService",function(e,n,t){function o(){function o(n){var t=i.getCurrentStep();t.colors.background=a.colors.background,t.colors.lines=a.colors.lines,t.colors.overLines=a.colors.overLines,t.camera.cameraHeight=a.camera.cameraHeight,t.camera.targetHeight=a.camera.targetHeight,t.circle.position.copy(a.circle.position),e.$broadcast("onOptionsChanged")}var a=n,i=t,c=new dat.GUI;a.randomize=function(){for(var e=0;e<c.__controllers.length;e++){var n=c.__controllers[e];if(n.__min){var t=n.__min+(n.__max-n.__min)*Math.random();this[n.property]=t,n.updateDisplay()}n.__color&&(n.__color.r=Math.floor(255*Math.random()),n.__color.g=Math.floor(255*Math.random()),n.__color.b=Math.floor(255*Math.random()),n.updateDisplay(),n.setValue(n.__color.hex))}},a.saveJson=function(){console.log("saveJson"),r(i.steps,"rossini.js",!0,!0)},c.closed=!0,c.add(a.camera,"cameraHeight",-20,20).listen().onChange(o),c.add(a.camera,"targetHeight",-20,20).listen().onChange(o);var s=c.addFolder("circlePosition");s.add(a.circle.position,"x",-300,300).listen().onChange(o),s.add(a.circle.position,"y",-300,300).listen().onChange(o),s.add(a.circle.position,"z",-300,300).listen().onChange(o);var l=c.addFolder("colors");return l.addColor(a.colors,"background").listen().onChange(o),l.addColor(a.colors,"lines").listen().onChange(o),l.addColor(a.colors,"overLines").listen().onChange(o),c.add(a,"audioVolume",.01,1).onChange(o),c.add(a,"audioStrength",10,100).onChange(o),c.add(a,"noiseStrength",10,100).onChange(o),c.add(a,"circularStrength",.01,.9).onChange(o),c.add(a,"randomize"),c.add(a,"saveJson"),o(),c}var r=function(){var e=document.createElement("a");return document.body.appendChild(e),e.style="display: none",function(n,t,o,r){o&&(n=r?JSON.stringify(n,null,2):JSON.stringify(n));var a=new Blob([n],{type:"octet/stream"}),i=window.URL.createObjectURL(a);e.href=i,e.download=t,e.click(),window.URL.revokeObjectURL(i)}}();return o}])}(),function(){"use strict";function e(e,t){for(var o=e*t,r=new Uint8Array(o),a=new n,i=1,c=100*Math.random(),s=0;s<4;s++){for(var l=0;l<o;l++){var u=l%e,d=~~(l/e);r[l]+=Math.abs(a.noise(u/i,d/i,c)*i*1.75)}i*=5}return r}function n(){function e(e){return e*e*e*(e*(6*e-15)+10)}function n(e,n,t){return n+e*(t-n)}function t(e,n,t,o){var r=15&e,a=r<8?n:t,i=r<4?t:12==r||14==r?n:o;return(0==(1&r)?a:-a)+(0==(2&r)?i:-i)}for(var o=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],r=0;r<256;r++)o[256+r]=o[r];return{noise:function(r,a,i){var c=Math.floor(r),s=Math.floor(a),l=Math.floor(i),u=255&c,d=255&s,p=255&l;r-=c,a-=s,i-=l;var g=r-1,f=a-1,h=i-1,v=e(r),m=e(a),w=e(i),b=o[u]+d,y=o[b]+p,E=o[b+1]+p,C=o[u+1]+d,H=o[C]+p,T=o[C+1]+p;return n(w,n(m,n(v,t(o[y],r,a,i),t(o[H],g,a,i)),n(v,t(o[E],r,f,i),t(o[T],g,f,i))),n(m,n(v,t(o[y+1],r,a,h),t(o[H+1],g,a,i-1)),n(v,t(o[E+1],r,f,h),t(o[T+1],g,f,h))))}}}function t(e,n,t){var o=2*Math.random()-1,r=Math.abs(o);return(t?Math.floor(o/r):1)*(e+(n-e)*r)}var o=angular.module("app");Number.prototype.mod=function(e){return(this%e+e)%e},o.service("AnalyserService",["$rootScope","$q","$http","SceneOptions","StepperService",function(e,n,t,o,r){function a(){if(!y){var e;y=b.createMediaElementSource(g),y.connect(p),y.connect(b.destination),p.fftSize=2*v.bands,e=p.frequencyBinCount,h.data=new Uint8Array(e),console.log("AnalyserService.attachAnalyser")}return h.data}function i(e){f!==e&&(f=e,g.src=e,g.volume=v.audioVolume,console.log("AnalyserService.setAudioUrl",e),g.play())}function c(){g&&g.play()}function s(){g&&g.pause()}function l(){g&&(h.active=!h.active,h.active?g.play():g.pause())}function u(){i(m.getCurrentStep().audio.url)}function d(){h.data&&p.getByteFrequencyData(h.data)}var p,g,f,h=this,v=o,m=r,w=window.AudioContext||window.webkitAudioContext,b=new w;p=b.createAnalyser(),g=new Audio,g.addEventListener("canplay",a);var y=null;e.$on("onStepChanged",function(e){u()}),e.$on("onOptionsChanged",function(e){g&&(g.volume=v.audioVolume)}),this.active=!0,this.audio=g,this.data=null,this.update=d,this.play=c,this.pause=s,this.toggle=l}]),o.directive("scene",["SceneOptions","StepperService","AnalyserService",function(n,o,r){return{restrict:"A",scope:{data:"=scene"},link:function(a,i,c){function s(){function e(){console.log("objects.ribbon.add"),w.add(v)}function n(){console.log("objects.ribbon.remove"),w.remove(v)}function o(){var e=1/h.steps.length*.1,n=h.values.pow,t=(n+e).mod(1),o=(h.getCurrentStep(),u.getPointAt(n));o.y+=h.values.cameraHeight;var r=u.getPointAt(t);r.y+=h.values.targetHeight,b.position.copy(o),b.target.copy(r),b.lookAt(b.target)}function r(){new THREE.Vector2(window.innerWidth,window.innerHeight);return new MeshLineMaterial({color:h.values.lines,lineWidth:5,depthTest:!0})}function a(){g.ribbon.material=r(),g.ribbon.object.material=g.ribbon.material}var i=r(),c=new THREE.Vector3,s=new Array(f.ribbon.points).fill(null).map(function(){var e=(new THREE.Vector3).copy(c);return c.x+=t(500,1e3,!0),c.y+=t(5,20,!0),c.z+=t(1e3,2e3,!1),e}),l=new THREE.CatmullRomCurve3(s);l.type="catmullrom",l.closed=!1;var u=new THREE.CatmullRomCurve3(l.points.map(function(e){return new THREE.Vector3(e.x,e.y+20,e.z)}));u.type="catmullrom",u.closed=!1;var d=new THREE.Geometry;d.vertices=l.getPoints(f.ribbon.vertices);var p=new MeshLine;p.setGeometry(d);var v=new THREE.Mesh(p.geometry,i);return e(),b.target=b.target||new THREE.Vector3(0,0,0),{object:v,spline:l,cameraSpline:u,geometry:d,material:i,add:e,remove:n,update:o,updateMaterial:a}}function l(e){function n(){console.log("objects.circles.add"),w.add(u),x.adding=Date.now(),x.removing=!1,x.enabled=!0,x.tween&&x.tween.kill(),x.tween=TweenLite.to(x,x.duration,{pow:1,delay:0,ease:Power2.easeInOut,onComplete:function(){x.adding=!1}})}function t(){console.log("objects.circles.remove"),x.adding=!1,x.removing=Date.now(),x.tween&&x.tween.kill(),x.tween=TweenLite.to(x,x.duration,{pow:0,delay:0,ease:Power2.easeInOut,onComplete:function(){x.removing=!1,x.enabled=!1,w.remove(u)}})}function o(e,n){var t=new THREE.Geometry,o=a(t,n,1),r=null;return r=new THREE.LineLoop(t,d),m.push(o),$.add(r),r}function r(e,n){var t=new THREE.Geometry,o=a(t,n,2),r=null;return r=new THREE.LineLoop(t,p),y.push(o),M.add(r),r}function a(n,t,o){return new Array(E).fill(null).map(function(r,a){var i=a/E,c=360*i;c+=60*e,c+=30*o,c+=360/E*.1*t;var s=c*Math.PI/180,l=f.radius,u=0;return u+=t*t*t*.005,r=new THREE.Vector3,r.sincos={base:l,increment:u,radius:l,x:Math.cos(s),y:Math.sin(s)},n.vertices.push(r),r})}function i(e,n,t,o){var r=f.audioStrength,a=f.noiseStrength,i=f.circularStrength,c=v.data;angular.forEach(n,function(e,n){var s=n%f.bands,l=(E-1-n)%f.bands,u=c?(c[s]+c[l])/2/f.bands:0,d=1===o?0:64,p=t*E+(n+d+O)%E,g=t*E+(E-1-n-d+O)%E,h=(f.noiseMap[p]+f.noiseMap[g])/2/64,v=1-(C-t)/C*i,m=e.sincos.base+e.sincos.increment*h+e.sincos.increment*u+a*h*v+r*u*v+0;e.sincos.radius=m,e.x=e.sincos.x*e.sincos.radius,e.y=e.sincos.y*e.sincos.radius,e.z=0}),e.verticesNeedUpdate=!0}function c(){angular.forEach(L,function(e,n){i(e.geometry,m[n],n,1)}),angular.forEach(A,function(e,n){i(e.geometry,y[n],n,2)}),$.rotation.z+=.001,M.rotation.z-=.001;var n=h.getStepAtIndex(e);H.position.copy(n.circle.position);var t=g.ribbon.cameraSpline.getPointAt((e+.1)/h.steps.length);t.y+=h.values.targetHeight,u.position.copy(t),u.scale.x=u.scale.y=u.scale.z=.001+.1*x.pow,u.lookAt(b.position),s()}function s(){d.color=h.values.lines,p.color=h.values.overLines}var l,u,d=new THREE.LineBasicMaterial({color:h.values.lines}),p=new THREE.LineBasicMaterial({color:h.values.overLines});new THREE.Vector2(window.innerWidth,window.innerHeight);u=new THREE.Object3D;var m=[],y=[],E=f.points,C=f.lines,H=new THREE.Object3D;u.add(H);var T=h.steps[e],S=(new THREE.TextureLoader).load(T.circle.texture);S.wrapS=THREE.RepeatWrapping,S.wrapT=THREE.RepeatWrapping,S.repeat.set(1,1);var k=new THREE.MeshBasicMaterial({color:16777215,map:S,transparent:!0});l=new THREE.PlaneGeometry(2*f.radius-20,2*f.radius-20,8,8);var R=new THREE.Mesh(l,k);H.add(R);var $=new THREE.Object3D;H.add($);var M=new THREE.Object3D;H.add(M);var L=new Array(C).fill(null).map(o),A=new Array(C).fill(null).map(r),x={pow:0,duration:.35,enabled:!1,adding:!1,removing:!1},O=0;return{add:n,remove:t,object:u,state:x,update:c,updateMaterial:s}}function u(){v.update(),S&&S.update(),g.ribbon&&g.ribbon.update(),angular.forEach(g.circles,function(e){e&&e.state.enabled&&e.update()}),y.render(w,b)}function d(){m.begin(),u(),m.end(),requestAnimationFrame(d)}var p=a.data;if(p){var g=p.objects,f=n,h=o,v=r;f.noiseMap=e(f.points,f.lines);var m,w,b,y,E,C,H,T,S=null;a.$on("onStepChanged",function(e,n){console.log("onStepChanged",n.current);var t=null,o=n.current,r=n.previous;o>0&&(t=g.circles[o]||l(o),t.add()),g.circles[o]=t,setTimeout(function(){if(h.current!==r&&r>0){var e=g.circles[r];e&&e.remove()}},1e3*h.duration),console.log("objects",g)}),a.$on("onOptionsChanged",function(e){g.ribbon&&g.ribbon.updateMaterial(),angular.forEach(g.circles,function(e){e&&e.updateMaterial()})}),function(){E=window.innerWidth,C=window.innerHeight,H=E/2,T=C/2;var e=E/C;w=new THREE.Scene,b=new THREE.PerspectiveCamera(30,e,.001,2e4),y=new THREE.WebGLRenderer({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0}),y.setClearColor(0,0),y.setSize(E,C),m=new Stats,i[0].appendChild(y.domElement),i[0].appendChild(m.dom)}(),function(){g.ribbon=s(),g.circles=new Array(h.steps).fill(null)}(),function(){function e(){E=window.innerWidth,C=window.innerHeight,H=E/2,T=C/2,y.setSize(E,C),b.aspect=E/C,b.updateProjectionMatrix()}window.addEventListener("resize",e,!1)}(),d()}}}}])}(),function(){"use strict";var e=angular.module("app");e.directive("slickBackgrounds",[function(){return{restrict:"A",link:function(e,n,t){function o(){n.hasClass("slick-initialized")&&n.slick("unslick")}function r(){o(),n.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,lazyLoad:"ondemand",cssEase:"cubic-bezier(0.7, 0, 0.3, 1)"})}e.$watchCollection(t.slickBackgrounds,function(e){e&&e.length&&r()}),e.$on("$destroy",function(){o()})}}}]),e.directive("slickTunnel",[function(){return{restrict:"A",link:function(e,n,t){function o(){n.hasClass("slick-initialized")&&n.slick("unslick")}function r(){o(),n.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,draggable:!1,asNavFor:".tunnel-bg",cssEase:"cubic-bezier(0.7, 0, 0.3, 1)"})}function a(){var e=$(".slick-active .splitted-letter");TweenMax.staggerTo(e,1,{delay:.2,y:0,x:0,ease:Power3.easeInOut,className:"+=viewed",onComplete:function(){$(".slick-active .cta").addClass("active")}},.009)}function i(n,t,o,r){u=!0;var a=$(".slick-active .splitted-letter");TweenMax.staggerTo(a,1,{delay:0,y:100,x:50,ease:Power3.easeInOut,className:"-=viewed"},.009),$(".slick-active .cta").removeClass("active"),e.$root.$broadcast("onSlickBeforeChange",{current:r,previouse:o})}function c(){u=!1;var n=$(".slick-active .splitted-letter");TweenMax.staggerTo(n,1,{delay:.2,y:0,x:0,ease:Power3.easeInOut,className:"+=viewed",onComplete:function(){$(".slick-active .cta").addClass("active")}},.009),e.$root.$broadcast("onAfterChange")}function s(e){u||(n.hasClass("slick-initialized")&&(e.deltaX>0||e.deltaY<0?n.slick("slickNext"):(e.deltaX<0||e.deltaY>0)&&n.slick("slickPrev")),e.preventDefault())}function l(){n.off("init",a).off("beforeChange",i).off("afterChange",c).off("mousewheel",s)}e.$watchCollection(t.slickTunnel,function(e){e&&e.length&&r()});var u=!1;e.$on("onGoStep",function(e,t){n.hasClass("slick-initialized")&&n.slick("slickGoTo",t)}),function(){n.on("init",a).on("beforeChange",i).on("afterChange",c).on("mousewheel",s)}(),e.$on("$destroy",function(){l(),o()})}}}])}(),function(){"use strict";angular.module("app").directive("splitText",[function(){return{restrict:"A",link:function(e,n,t){function o(){var e=n[0].childNodes;e=Array.prototype.slice.call(e,0),n.html("").addClass("active");var t=[[]];e.filter(function(e){return 3===e.nodeType||1===e.nodeType}).map(function(e){if(3===e.nodeType)e={text:$.trim(e.textContent),element:"span"};else{if("br"===e.nodeName.toLowerCase())return void t.push([]);e={text:$.trim(e.innerHTML),element:e.nodeName}}""!==e.text&&t[t.length-1].push(e)});for(var o=0;o<t.length;o++){var r=t[o];$('<div class="splitted-row"></div>').appendTo(n);for(var a=0;a<r.length;a++)for(var i=r[a],c=i.element.toLowerCase(),s=i.text,l=s.split(" "),u=0;u<l.length;u++){$("<"+c+' class="splitted-word"></'+c+">").appendTo($(".splitted-row:last"),n);for(var d=l[u],p=d.split(""),g=0;g<p.length;g++){var f=p[g];$('<span class="splitted-letter" data-content="'+f+'">'+f+"</span>").appendTo($(".splitted-word:last"),n)}$('<span class="splitted-space">&nbsp;</span>').appendTo($(".splitted-word:last"),n)}}}setTimeout(function(){o()},1)}}}])}(),function(){"use strict";angular.module("app").directive("yearsFrom",[function(){return{restrict:"A",scope:{from:"=yearsFrom",to:"=yearsTo"},link:function(e,n,t){function o(){function t(){o.html(parseInt(i.from)),r.html(parseInt(i.to))}console.log("onChangeYears",e.from,e.to);var o=n.find(".tunnel-year__from"),r=n.find(".tunnel-year__to"),a=Power3.easeOut,i={from:o.html(),to:r.html()};e.to?(n.removeClass("one-year"),TweenLite.to(i,2,{to:e.to,roundProps:"year",onUpdate:t,ease:a})):(n.addClass("one-year"),TweenLite.to(i,2,{to:e.from,roundProps:"year",onUpdate:t,ease:a})),TweenLite.to(i,2,{from:e.from,roundProps:"year",onUpdate:t,ease:a})}e.$watch("from",function(e,n){e&&o()})}}}])}(),function(){"use strict";var e=angular.module("app");e.constant("SceneOptions",{colors:{background:15395048,lines:11845597,overLines:3363748},camera:{cameraHeight:0,targetHeight:5},circle:{position:new THREE.Vector3},ribbon:{steps:12,points:24,vertices:2400},audioVolume:.9,bands:128,points:128,lines:32,radius:200,audioStrength:100,noiseStrength:25,circularStrength:.9}),e.controller("RootCtrl",["$scope","SceneOptions","StepperService","AnalyserService","DatGui",function(e,n,t,o,r){var a={objects:{},options:n,stepper:t},i=a.stepper;i.init().then(function(){e.scene=a,e.stepper=i,e.audio=o;new r})}]),e.service("StepperService",["$rootScope","$timeout","$q","$http","$sce","SceneOptions",function(e,n,t,o,r,a){function i(){var e=["Il periodo francese:<br> la nascita della <em>Grand Opéra</em>","Il Barbiere di Siviglia<br> al teatro Argentina<br> di Roma","Il Silenzio"],n=["Il giovane Gioacchino","Il folgorante debutto","La frenesia della produzione","Sulle strade di Parigi"],t=["Il Barbiere di Siviglia","L'italiana in Algeri"],o=["audio/07-rossini-192.mp3","audio/08-rossini-192.mp3"],r=["img/tunnel-1.jpg","img/tunnel-2.jpg","img/tunnel-3.jpg"],i=["light-bg","light-bg","dark-bg"];return new Array(m.ribbon.steps).fill().map(function(c,s){return{id:s+1,title:e[s%e.length],chapter:"Passione, Genio e Silenzio",paragraph:n[Math.floor(s/3)%n.length],years:{from:1812+Math.round(50*Math.random()),to:1812+Math.round(50*Math.random())},background:r[s%r.length],contrast:i[s%i.length],colors:angular.copy(a.colors),camera:{cameraHeight:0,targetHeight:0},circle:{position:new THREE.Vector3(0,0,0),texture:"img/rossini-01.png"},audio:{url:o[s%o.length],title:t[s%t.length],orchestra:"Academy of St Martin in the Fields Orchestra"}}})}function c(){var e=t.defer();return o.get("json/rossini.js").then(function(n){var t=i();angular.forEach(t,function(e){e.titleTrusted=r.trustAsHtml(e.title),e.circle.position=(new THREE.Vector3).copy(e.circle.position),b.push(e)}),d(0),console.log("StepperService.load",b),e.resolve(b)},function(n){e.reject(n)}),e.promise}function s(){for(;y.length;){y.pop().kill()}}function l(e,n,t,o){s();var r=new THREE.Color(n.colors.background),a=new THREE.Color(n.colors.lines),i=new THREE.Color(n.colors.overLines);y.push(TweenLite.to(v.values,t,{pow:e,cameraHeight:n.camera.cameraHeight,targetHeight:n.camera.targetHeight,delay:0,ease:Power2.easeInOut,onComplete:function(){o&&o()}})),y.push(TweenLite.to(v.values.background,t,{r:r.r,g:r.g,b:r.b,delay:0,ease:Power2.easeInOut,onUpdate:function(){var e=v.values.background.getHexString();document.body.style.backgroundColor="#"+e}})),y.push(TweenLite.to(v.values.lines,t,{r:a.r,g:a.g,b:a.b,delay:0,ease:Power2.easeInOut})),y.push(TweenLite.to(v.values.overLines,t,{r:i.r,g:i.g,b:i.b,delay:0,ease:Power2.easeInOut}))}function u(e){var n=v.current,t=b[n];l(n/b.length,t,e,function(){s(),console.log(t,v.values)})}function d(t){n(function(){var n=v.current||0;v.current=t;var o=b[t];v.step=o,m.colors.background=o.colors.background,m.colors.lines=o.colors.lines,m.colors.overLines=o.colors.overLines,m.camera.cameraHeight=o.camera.cameraHeight,m.camera.targetHeight=o.camera.targetHeight,m.circle.position.copy(o.circle.position),e.$broadcast("onStepChanged",{current:t,previous:n}),console.log("onStepChanged",t,o),u(v.duration)})}function p(){w++,w=Math.min(b.length-1,w),d(w),e.$broadcast("onGoStep",w)}function g(){w--,w=Math.max(0,w),d(w),e.$broadcast("onGoStep",w)}function f(){return b[w]}function h(e){return b[e]}var v=this,m=a,w=0,b=[],y=[],E={pow:0,background:new THREE.Color(m.colors.background),lines:new THREE.Color(m.colors.lines),overLines:new THREE.Color(m.colors.overLines),cameraHeight:m.camera.cameraHeight,targetHeight:m.camera.targetHeight};e.$on("onOptionsChanged",function(){var e=v.current,n=b[e];v.values.cameraHeight=n.camera.cameraHeight,v.values.targetHeight=n.camera.targetHeight,v.values.background.copy(new THREE.Color(n.colors.background)),v.values.lines.copy(new THREE.Color(n.colors.lines)),v.values.overLines.copy(new THREE.Color(n.colors.overLines))}),e.$on("onSlickBeforeChange",function(e,n){d(n.current)}),this.init=c,this.values=E,this.duration=2.5,this.steps=b,this.current=w,this.next=p,this.previous=g,this.getCurrentStep=f,this.getStepAtIndex=h}]),e.directive("scrollbar",[function(){return{restrict:"A",link:function(e,n,t,o){function r(){var n=Scrollbar.init(a,i);console.log(n),e.$watch(n.contentEl.offsetHeight,function(e){n.update()})}var a=n[0],i={speed:1,damping:.1,overscrollDamping:1,thumbMinSize:20,continuousScrolling:!0,alwaysShowTracks:!1};setTimeout(r,100)}}}])}();
//# sourceMappingURL=app.min.js.map
=======
(function(){"use strict";var n=angular.module("app",["ngRoute","ngSanitize","jsonFormatter"])})(),function(){"use strict";var n=angular.module("app");n.config(["$httpProvider",function(){}])}(),function(){"use strict";var n=angular.module("app");n.config(["$locationProvider",function(n){n.html5Mode(!0);n.hashPrefix("")}])}(),function(){"use strict";var n=angular.module("app");n.run(["$rootScope",function(){}])}(),function(){"use strict";var n=angular.module("app");n.factory("DatGui",["$rootScope","SceneOptions","StepperService",function(n,t,i){function u(){function e(){var t=h.getCurrentStep();t.colors.background=u.colors.background;t.colors.lines=u.colors.lines;t.colors.overLines=u.colors.overLines;t.camera.cameraHeight=u.camera.cameraHeight;t.camera.targetHeight=u.camera.targetHeight;t.circle.position.copy(u.circle.position);n.$broadcast("onOptionsChanged")}var u=t,h=i,f=new dat.GUI,o,s;u.randomize=function(){for(var n,i,t=0;t<f.__controllers.length;t++)n=f.__controllers[t],n.__min&&(i=n.__min+(n.__max-n.__min)*Math.random(),this[n.property]=i,n.updateDisplay()),n.__color&&(n.__color.r=Math.floor(Math.random()*255),n.__color.g=Math.floor(Math.random()*255),n.__color.b=Math.floor(Math.random()*255),n.updateDisplay(),n.setValue(n.__color.hex))};u.saveJson=function(){console.log("saveJson");r(h.steps,"rossini.js",!0,!0)};f.closed=!0;f.add(u.camera,"cameraHeight",-20,20).listen().onChange(e);f.add(u.camera,"targetHeight",-20,20).listen().onChange(e);o=f.addFolder("circlePosition");o.add(u.circle.position,"x",-300,300).listen().onChange(e);o.add(u.circle.position,"y",-300,300).listen().onChange(e);o.add(u.circle.position,"z",-300,300).listen().onChange(e);s=f.addFolder("colors");s.addColor(u.colors,"background").listen().onChange(e);s.addColor(u.colors,"lines").listen().onChange(e);s.addColor(u.colors,"overLines").listen().onChange(e);f.add(u,"audioVolume",.01,1).onChange(e);f.add(u,"audioStrength",10,100).onChange(e);f.add(u,"noiseStrength",10,100).onChange(e);f.add(u,"circularStrength",.01,.9).onChange(e);return f.add(u,"randomize"),f.add(u,"saveJson"),e(),f}var r=function(){var n=document.createElement("a");return document.body.appendChild(n),n.style="display: none",function(t,i,r,u){r&&(t=u?JSON.stringify(t,null,2):JSON.stringify(t));var e=new Blob([t],{type:"octet/stream"}),f=window.URL.createObjectURL(e);n.href=f;n.download=i;n.click();window.URL.revokeObjectURL(f)}}();return u}])}(),function(){"use strict";function i(n,t){for(var i,s,h,f=n*t,e=new Uint8Array(f),c=new r,u=1,l=Math.random()*100,o=0;o<4;o++){for(i=0;i<f;i++)s=i%n,h=~~(i/n),e[i]+=Math.abs(c.noise(s/u,h/u,l)*u*1.75);u*=5}return e}function r(){function u(n){return n*n*n*(n*(n*6-15)+10)}function i(n,t,i){return t+n*(i-t)}function t(n,t,i,r){var u=n&15,f=u<8?t:i,e=u<4?i:u==12||u==14?t:r;return((u&1)==0?f:-f)+((u&2)==0?e:-e)}for(var n=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],r=0;r<256;r++)n[256+r]=n[r];return{noise:function(r,f,e){var a=Math.floor(r),v=Math.floor(f),y=Math.floor(e),p=a&255,w=v&255,o=y&255;r-=a;f-=v;e-=y;var s=r-1,h=f-1,l=e-1,c=u(r),b=u(f),rt=u(e),k=n[p]+w,d=n[k]+o,g=n[k+1]+o,nt=n[p+1]+w,tt=n[nt]+o,it=n[nt+1]+o;return i(rt,i(b,i(c,t(n[d],r,f,e),t(n[tt],s,f,e)),i(c,t(n[g],r,h,e),t(n[it],s,h,e))),i(b,i(c,t(n[d+1],r,f,l),t(n[tt+1],s,f,e-1)),i(c,t(n[g+1],r,h,l),t(n[it+1],s,h,l))))}}}function n(n,t,i){var r=-1+Math.random()*2,u=Math.abs(r),f=i?Math.floor(r/u):1;return f*(n+(t-n)*u)}var t=angular.module("app");Number.prototype.mod=function(n){return(this%n+n)%n};t.service("AnalyserService",["$rootScope","$q","$http","SceneOptions","StepperService",function(n,t,i,r,u){function a(){var n,t,i=window.AudioContext||window.webkitAudioContext;n=null;t=new i;o=t.createAnalyser();f=new Audio;f.addEventListener("canplay",function(){var i;return console.log("audio canplay"),n=t.createMediaElementSource(f),n.connect(o),n.connect(t.destination),o.fftSize=s.bands*2,i=o.frequencyBinCount,e.data=new Uint8Array(i),e.data});c()}function v(n){h!==n&&(h=n,f.src=n,f.volume=s.audioVolume,f.play())}function y(){f&&f.play()}function p(){f&&f.pause()}function w(){f&&(e.active=!e.active,e.active?f.play():f.pause())}function c(){var n=l.getCurrentStep();v(n.audio.url)}function b(){e.data&&o.getByteFrequencyData(e.data)}var e=this,s=r,l=u,o,f,h;n.$on("onStepChanged",function(){c()});n.$on("onOptionsChanged",function(){f&&(f.volume=s.audioVolume)});this.active=!0;this.audio=f;this.data=null;this.init=a;this.update=b;this.play=y;this.pause=p;this.toggle=w}]);t.directive("scene",["SceneOptions","StepperService","AnalyserService",function(t,r,u){return{restrict:"A",scope:{data:"=scene"},link:function(f,e){function ut(){a=window.innerWidth;v=window.innerHeight;tt=a/2;it=v/2;var n=a/v;l=new THREE.Scene;c=new THREE.PerspectiveCamera(30,n,.001,2e4);y=new THREE.WebGLRenderer({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0});y.setClearColor(0,0);y.setSize(a,v);p=new Stats;e[0].appendChild(y.domElement);e[0].appendChild(p.dom)}function ft(){h.ribbon=et();h.circles=new Array(s.steps).fill(null)}function et(){function v(){console.log("objects.ribbon.add");l.add(f)}function w(){console.log("objects.ribbon.remove");l.remove(f)}function b(){var u=1/s.steps.length*.1,i=s.values.pow,f=(i+u).mod(1),e=s.getCurrentStep(),r=t.getPointAt(i),n;r.y+=s.values.cameraHeight;n=t.getPointAt(f);n.y+=s.values.targetHeight;c.position.copy(r);c.target.copy(n);c.lookAt(c.target)}function y(){var n=new THREE.Vector2(window.innerWidth,window.innerHeight);return new MeshLineMaterial({color:s.values.lines,lineWidth:5,depthTest:!0})}function k(){h.ribbon.material=y();h.ribbon.object.material=h.ribbon.material}var a=y(),r=new THREE.Vector3,p=new Array(o.ribbon.points).fill(null).map(function(){var t=(new THREE.Vector3).copy(r);return r.x+=n(500,1e3,!0),r.y+=n(5,20,!0),r.z+=n(1e3,2e3,!1),t}),i=new THREE.CatmullRomCurve3(p),t,u,e,f;return i.type="catmullrom",i.closed=!1,t=new THREE.CatmullRomCurve3(i.points.map(function(n){return new THREE.Vector3(n.x,n.y+20,n.z)})),t.type="catmullrom",t.closed=!1,u=new THREE.Geometry,u.vertices=i.getPoints(o.ribbon.vertices),e=new MeshLine,e.setGeometry(u),f=new THREE.Mesh(e.geometry,a),v(),c.target=c.target||new THREE.Vector3(0,0,0),{object:f,spline:i,cameraSpline:t,geometry:u,material:a,add:v,remove:w,update:b,updateMaterial:k}}function ot(n){function st(){console.log("objects.circles.add");l.add(i);t.adding=Date.now();t.removing=!1;t.enabled=!0;t.tween&&t.tween.kill();t.tween=TweenLite.to(t,t.duration,{pow:1,delay:0,ease:Power2.easeInOut,onComplete:function(){t.adding=!1}})}function ht(){console.log("objects.circles.remove");t.adding=!1;t.removing=Date.now();t.tween&&t.tween.kill();t.tween=TweenLite.to(t,t.duration,{pow:0,delay:0,ease:Power2.easeInOut,onComplete:function(){t.removing=!1;t.enabled=!1;l.remove(i)}})}function ct(n,t){var r=new THREE.Geometry,u=rt(r,t,1),i=null;return i=new THREE.LineLoop(r,w),d.push(u),a.add(i),i}function lt(n,t){var r=new THREE.Geometry,u=rt(r,t,2),i=null;return i=new THREE.LineLoop(r,b),g.push(u),v.add(i),i}function rt(t,i,u){return new Array(r).fill(null).map(function(f,e){var a=e/r,s=360*a;s+=60*n;s+=30*u;s+=360/r*.1*i;var h=s*Math.PI/180,c=o.radius,l=0;return l+=u===1?i*i*i*.005:i*i*i*.005,f=new THREE.Vector3,f.sincos={base:c,increment:l,radius:c,x:Math.cos(h),y:Math.sin(h)},t.vertices.push(f),f})}function ut(n,t,i,u){var s=o.audioStrength,h=o.noiseStrength,c=o.circularStrength,f=k.data;angular.forEach(t,function(n,t){var w=t%o.bands,b=(r-1-t)%o.bands,l=f?(f[w]+f[b])/2/o.bands:0,a=u===1?0:64,k=i*r+(t+a+y)%r,d=i*r+(r-1-t-a+y)%r,v=(o.noiseMap[k]+o.noiseMap[d])/128,p=1-(e-i)/e*c,g=n.sincos.base+n.sincos.increment*v+n.sincos.increment*l+h*v*p+s*l*p+0;n.sincos.radius=g;n.x=n.sincos.x*n.sincos.radius;n.y=n.sincos.y*n.sincos.radius;n.z=0});n.verticesNeedUpdate=!0}function at(){var f,r;angular.forEach(et,function(n,t){ut(n.geometry,d[t],t,1)});angular.forEach(ot,function(n,t){ut(n.geometry,g[t],t,2)});a.rotation.z+=.001;v.rotation.z-=.001;f=s.getStepAtIndex(n);u.position.copy(f.circle.position);r=h.ribbon.cameraSpline.getPointAt((n+.1)/s.steps.length);r.y+=s.values.targetHeight;i.position.copy(r);i.scale.x=i.scale.y=i.scale.z=.001+.1*t.pow;i.lookAt(c.position);ft()}function ft(){w.color=s.values.lines;b.color=s.values.overLines}var p,i,w=new THREE.LineBasicMaterial({color:s.values.lines}),b=new THREE.LineBasicMaterial({color:s.values.overLines}),vt=new THREE.Vector2(window.innerWidth,window.innerHeight),nt,f,tt,it,a,v,y;i=new THREE.Object3D;var d=[],g=[],r=o.points,e=o.lines,u=new THREE.Object3D;i.add(u);nt=s.steps[n];f=(new THREE.TextureLoader).load(nt.circle.texture);f.wrapS=THREE.RepeatWrapping;f.wrapT=THREE.RepeatWrapping;f.repeat.set(1,1);tt=new THREE.MeshBasicMaterial({color:16777215,map:f,transparent:!0});p=new THREE.PlaneGeometry(o.radius*2-20,o.radius*2-20,8,8);it=new THREE.Mesh(p,tt);u.add(it);a=new THREE.Object3D;u.add(a);v=new THREE.Object3D;u.add(v);var et=new Array(e).fill(null).map(ct),ot=new Array(e).fill(null).map(lt),t={pow:0,duration:.35,enabled:!1,adding:!1,removing:!1};return y=0,{add:st,remove:ht,object:i,state:t,update:at,updateMaterial:ft}}function st(){k.update();d&&d.update();h.ribbon&&h.ribbon.update();angular.forEach(h.circles,function(n){n&&n.state.enabled&&n.update()});y.render(l,c)}function rt(){p.begin();st();p.end();requestAnimationFrame(rt)}function ht(){function n(){a=window.innerWidth;v=window.innerHeight;tt=a/2;it=v/2;y.setSize(a,v);c.aspect=a/v;c.updateProjectionMatrix()}window.addEventListener("resize",n,!1)}var g=f.data,p,l,c,w,b,nt,y,a,v,tt,it,d;if(g){var h=g.objects,o=t,s=r,k=u;o.noiseMap=i(o.points,o.lines);d=null;f.$on("onStepChanged",function(n,t){console.log("onStepChanged",t.current);var r=null,i=t.current,u=t.previous;i>0&&(r=h.circles[i]||ot(i),r.add());h.circles[i]=r;setTimeout(function(){if(s.current!==u&&u>0){var n=h.circles[u];n&&n.remove()}},s.duration*1e3);console.log("objects",h)});f.$on("onOptionsChanged",function(){h.ribbon&&h.ribbon.updateMaterial();angular.forEach(h.circles,function(n){n&&n.updateMaterial()})});ut();ft();ht();rt();k.init()}}}}])}(),function(){"use strict";var n=angular.module("app");n.directive("slickBackgrounds",[function(){return{restrict:"A",link:function(n,t,i){function r(){t.hasClass("slick-initialized")&&t.slick("unslick")}function u(){r();t.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,lazyLoad:"ondemand",cssEase:"cubic-bezier(0.7, 0, 0.3, 1)"})}n.$watchCollection(i.slickBackgrounds,function(n){n&&n.length&&u()});n.$on("$destroy",function(){r()})}}}]);n.directive("slickTunnel",[function(){return{restrict:"A",link:function(n,t,i){function u(){t.hasClass("slick-initialized")&&t.slick("unslick")}function h(){u();t.slick({arrows:!1,dots:!1,fade:!0,speed:1100,infinite:!1,draggable:!1,asNavFor:".tunnel-bg",cssEase:"cubic-bezier(0.7, 0, 0.3, 1)"})}function f(){var n=$(".slick-active .splitted-letter");TweenMax.staggerTo(n,1,{delay:.2,y:0,x:0,ease:Power3.easeInOut,className:"+=viewed",onComplete:function(){$(".slick-active .cta").addClass("active")}},.009)}function e(t,i,u,f){r=!0;var e=$(".slick-active .splitted-letter");TweenMax.staggerTo(e,1,{delay:0,y:100,x:50,ease:Power3.easeInOut,className:"-=viewed"},.009);$(".slick-active .cta").removeClass("active");n.$root.$broadcast("onSlickBeforeChange",{current:f,previouse:u})}function o(){r=!1;var t=$(".slick-active .splitted-letter");TweenMax.staggerTo(t,1,{delay:.2,y:0,x:0,ease:Power3.easeInOut,className:"+=viewed",onComplete:function(){$(".slick-active .cta").addClass("active")}},.009);n.$root.$broadcast("onAfterChange")}function s(n){r||(t.hasClass("slick-initialized")&&(n.deltaX>0||n.deltaY<0?t.slick("slickNext"):(n.deltaX<0||n.deltaY>0)&&t.slick("slickPrev")),n.preventDefault())}function c(){t.on("init",f).on("beforeChange",e).on("afterChange",o).on("mousewheel",s)}function l(){t.off("init",f).off("beforeChange",e).off("afterChange",o).off("mousewheel",s)}n.$watchCollection(i.slickTunnel,function(n){n&&n.length&&h()});var r=!1;n.$on("onGoStep",function(n,i){t.hasClass("slick-initialized")&&t.slick("slickGoTo",i)});c();n.$on("$destroy",function(){l();u()})}}}])}(),function(){"use strict";var n=angular.module("app");n.directive("splitText",[function(){return{restrict:"A",link:function(n,t){function i(){var e=t[0].childNodes,n,i,o,r,u,v,s,f,h;for(e=Array.prototype.slice.call(e,0),t.html("").addClass("active"),n=[[]],e.filter(function(n){return n.nodeType===3||n.nodeType===1}).map(function(t){if(t.nodeType===3)t={text:$.trim(t.textContent),element:"span"};else{if(t.nodeName.toLowerCase()==="br"){n.push([]);return}t={text:$.trim(t.innerHTML),element:t.nodeName}}t.text!==""&&n[n.length-1].push(t)}),i=0;i<n.length;i++)for(o=n[i],$('<div class="splitted-row"><\/div>').appendTo(t),r=0;r<o.length;r++){var c=o[r],l=c.element.toLowerCase(),y=c.text,a=y.split(" ");for(u=0;u<a.length;u++){for($("<"+l+' class="splitted-word"><\/'+l+">").appendTo($(".splitted-row:last"),t),v=a[u],s=v.split(""),f=0;f<s.length;f++)h=s[f],$('<span class="splitted-letter" data-content="'+h+'">'+h+"<\/span>").appendTo($(".splitted-word:last"),t);$('<span class="splitted-space">&nbsp;<\/span>').appendTo($(".splitted-word:last"),t)}}}setTimeout(function(){i()},1)}}}])}(),function(){"use strict";var n=angular.module("app");n.directive("yearsFrom",[function(){return{restrict:"A",scope:{from:"=yearsFrom",to:"=yearsTo"},link:function(n,t){function i(){function f(){e.html(parseInt(i.from));o.html(parseInt(i.to))}console.log("onChangeYears",n.from,n.to);var e=t.find(".tunnel-year__from"),o=t.find(".tunnel-year__to"),r=2,u=Power3.easeOut,i={from:e.html(),to:o.html()};n.to?(t.removeClass("one-year"),TweenLite.to(i,r,{to:n.to,roundProps:"year",onUpdate:f,ease:u})):(t.addClass("one-year"),TweenLite.to(i,r,{to:n.from,roundProps:"year",onUpdate:f,ease:u}));TweenLite.to(i,r,{from:n.from,roundProps:"year",onUpdate:f,ease:u})}n.$watch("from",function(n){n&&i()})}}}])}(),function(){"use strict";var n=angular.module("app");n.constant("SceneOptions",{colors:{background:15395048,lines:11845597,overLines:3363748},camera:{cameraHeight:0,targetHeight:5},circle:{position:new THREE.Vector3},ribbon:{steps:12,points:24,vertices:2400},audioVolume:.9,bands:128,points:128,lines:32,radius:200,audioStrength:100,noiseStrength:25,circularStrength:.9});n.controller("RootCtrl",["$scope","SceneOptions","StepperService","AnalyserService","DatGui",function(n,t,i,r,u){var f={objects:{},options:t,stepper:i},o=f.objects,s=f.options,e=f.stepper;e.init().then(function(){n.scene=f;n.stepper=e;n.audio=r;var t=new u})}]);n.service("StepperService",["$rootScope","$timeout","$q","$http","$sce","SceneOptions",function(n,t,i,r,u,f){function y(){var n=["Il periodo francese:<br> la nascita della <em>Grand Opéra<\/em>","Il Barbiere di Siviglia<br> al teatro Argentina<br> di Roma","Il Silenzio",],t=["Il Barbiere di Siviglia","L'italiana in Algeri",],i=["audio/07-rossini-192.mp3","audio/08-rossini-192.mp3",],r=["img/tunnel-1.jpg","img/tunnel-2.jpg","img/tunnel-3.jpg",],u=["light-bg","light-bg","dark-bg",];return new Array(o.ribbon.steps).fill().map(function(e,o){return{id:o+1,name:"Step "+(o+1),title:n[o%n.length],chapter:"Passione, Genio e Silenzio",paragraph:"Sulle strade di Parigi",years:{from:1812+Math.round(Math.random()*50),to:1812+Math.round(Math.random()*50)},background:r[o%r.length],contrast:u[o%u.length],colors:angular.copy(f.colors),camera:{cameraHeight:0,targetHeight:0},circle:{position:new THREE.Vector3(0,0,0),texture:"img/rossini-01.png"},audio:{url:i[o%i.length],title:t[o%t.length],orchestra:"Academy of St Martin in the Fields Orchestra"}}})}function p(){var n=i.defer();return r.get("json/rossini.js").then(function(){var t=y();angular.forEach(t,function(n){n.titleTrusted=u.trustAsHtml(n.title);n.circle.position=(new THREE.Vector3).copy(n.circle.position);h.push(n)});l(0);console.log("StepperService.load",h);n.resolve(h)},function(t){n.reject(t)}),n.promise}function a(){while(c.length){var n=c.pop();n.kill()}}function w(n,t,i,r){a();var u=new THREE.Color(t.colors.background),f=new THREE.Color(t.colors.lines),o=new THREE.Color(t.colors.overLines);c.push(TweenLite.to(e.values,i,{pow:n,cameraHeight:t.camera.cameraHeight,targetHeight:t.camera.targetHeight,delay:0,ease:Power2.easeInOut,onComplete:function(){r&&r()}}));c.push(TweenLite.to(e.values.background,i,{r:u.r,g:u.g,b:u.b,delay:0,ease:Power2.easeInOut,onUpdate:function(){var n=e.values.background.getHexString();document.body.style.backgroundColor="#"+n}}));c.push(TweenLite.to(e.values.lines,i,{r:f.r,g:f.g,b:f.b,delay:0,ease:Power2.easeInOut}));c.push(TweenLite.to(e.values.overLines,i,{r:o.r,g:o.g,b:o.b,delay:0,ease:Power2.easeInOut}))}function b(n){var t=e.current,i=h[t];w(t/h.length,i,n,function(){a();console.log(i,e.values)})}function l(i){t(function(){var r=e.current||0,t;e.current=i;t=h[i];e.step=t;o.colors.background=t.colors.background;o.colors.lines=t.colors.lines;o.colors.overLines=t.colors.overLines;o.camera.cameraHeight=t.camera.cameraHeight;o.camera.targetHeight=t.camera.targetHeight;o.circle.position.copy(t.circle.position);n.$broadcast("onStepChanged",{current:i,previous:r});console.log("onStepChanged",i,t);b(e.duration)})}function k(){s++;s=Math.min(h.length-1,s);l(s);n.$broadcast("onGoStep",s)}function d(){s--;s=Math.max(0,s);l(s);n.$broadcast("onGoStep",s)}function g(){return h[s]}function nt(n){return h[n]}var e=this,o=f,s=0,h=[],c=[],v={pow:0,background:new THREE.Color(o.colors.background),lines:new THREE.Color(o.colors.lines),overLines:new THREE.Color(o.colors.overLines),cameraHeight:o.camera.cameraHeight,targetHeight:o.camera.targetHeight};n.$on("onOptionsChanged",function(){var t=e.current,n=h[t];e.values.cameraHeight=n.camera.cameraHeight;e.values.targetHeight=n.camera.targetHeight;e.values.background.copy(new THREE.Color(n.colors.background));e.values.lines.copy(new THREE.Color(n.colors.lines));e.values.overLines.copy(new THREE.Color(n.colors.overLines))});n.$on("onSlickBeforeChange",function(n,t){l(t.current)});this.init=p;this.values=v;this.duration=2.5;this.steps=h;this.current=s;this.next=k;this.previous=d;this.getCurrentStep=g;this.getStepAtIndex=nt}]);n.directive("scrollbar",[function(){return{restrict:"A",link:function(n,t){function u(){var t=Scrollbar.init(i,r);console.log(t);n.$watch(t.contentEl.offsetHeight,function(){t.update()})}var i=t[0],r={speed:1,damping:.1,overscrollDamping:1,thumbMinSize:20,continuousScrolling:!0,alwaysShowTracks:!1};setTimeout(u,100)}}}])}();
>>>>>>> d95ef4fe562921af52ad3ce7ac7e6971a8d51392
